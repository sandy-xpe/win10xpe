[Main]
Title=MS PowerShell
Type=XPEPlugin
Description=Plugin Requires Microsoft .Net Framework
Author=KYHI
Date=2019.03.31
Credits=2aCD,ChrisR,Lancelot,JFX
Contact=
Version=002
Level=5
Download_Level=2
Selected=False
Mandatory=False
NoWarning=False
History001=KYHI Initial XPE Plugin Created 2018.07.14
History002=KYHI - M&M Check - 2019.03.31

[Interface]
pCheckBox1="Add PowerShell Shortcuts To StartMenu",1,3,20,39,221,18,True
StartMenuFolder_TextBox="Start Menu Folder",1,0,36,76,200,21,PowerShell
pTextBox2="PowerShell ISE Name",1,0,36,119,200,21,"Window PowerShell ISE"
pTextBox3="PowerShell Name",1,0,36,161,200,21,"Window PowerShell"
pScrollBox1=Unrestricted,1,4,14,218,171,21,Restricted,AllSigned,RemoteSigned,Unrestricted,Bypass
pTextLabel2="Set Execution Policy For PowerShell",1,1,14,202,212,18,8,Normal
pBevel1=pBevel1,1,12,14,34,230,155

[Variables]
%ProgramTitle%=Microsoft PowerShell
%ProgramFolder%=MSPowerShell
%dfFolderSM%=Computer Management

[Process]
RunFromRam
Echo,"Processing %ScriptTitle%..."
Iniread,%ProjectDir%\Script.Project,Features,DotNET,%DotNET%
//If,%DotNET%,Equal,False,EchoExtended,"You Need To Enable > Microsoft .NETFx4 < In Build Core To Run %ProgramTitle%",,,Message,4,Exit
If,%DotNET%,Equal,False,Exec,%ProjectDir%\Features\DotNET.script,Process
//--
ExtractSectionFiles,%ScriptFile%,AddFiles
//If,%Architecture%%WoW64Support%,Equal,x64True,ExtractSectionFiles,%ScriptFile%,AddFiles6432
//--
Run,%ScriptFile%,Add_Shortcuts
//--
If,Not,#1,Equal,HiveLoaded,HiveLoadALL
Run,%ScriptFile%,Add_Registry
If,Not,#1,Equal,HiveLoaded,HiveUnLoadALL

[AddFiles]
\Program Files\WindowsPowerShell
\Windows\system32\??-??\mi.dll.mui
\Windows\system32\??-??\mispace.dll.mui
\Windows\system32\??-??\miutils.dll.mui
\Windows\System32\??-??\NgcRecovery.dll.mui
\Windows\System32\??-??\propsys.dll.mui
\Windows\System32\??-??\PSModuleDiscoveryProvider.dll.mui
\Windows\System32\??-??\psmodulediscoveryprovider.mfl
\Windows\system32\??-??\Pwrshplugin.dll.mui
\Windows\system32\??-??\storagewmi.dll.mui
\Windows\system32\??-??\TpmCoreProvisioning.dll.mui
\Windows\system32\??-??\UIAutomationCore.dll.mui
\Windows\system32\??-??\Wecsvc.dll.mui
\Windows\system32\??-??\Wecutil.exe.mui
\Windows\system32\??-??\Wevtfwd.dll.mui
\Windows\System32\??-??\Windows.ApplicationModel.dll.mui
\Windows\system32\??-??\Winrs.exe.mui
\Windows\system32\??-??\WinTypes.dll.mui
\Windows\system32\??-??\wmitomi.dll.mui
\Windows\system32\??-??\Wsmres.dll.mui
\Windows\system32\??-??\Wsmsvc.dll.mui
\Windows\System32\??-??\wuaueng.dll.mui
\windows\SYSTEM32\amsi.dll
\Windows\system32\Appxsip.dll
\windows\SYSTEM32\clbcatq.dll
\Windows\system32\mi.dll
\Windows\system32\Microsoft.Management.Infrastructure.Native.Unmanaged.dll
\Windows\system32\mispace.dll
\Windows\system32\miutils.dll
\Windows\system32\mscoree.dll
\windows\system32\NgcRecovery.dll
\Windows\system32\OpcServices.dll
\windows\system32\propsys.dll
\Windows\System32\PSModuleDiscoveryProvider.dll
\Windows\System32\psmodulediscoveryprovider.mof
\Windows\system32\Pwrshplugin.dll
\Windows\system32\storagewmi.dll
\Windows\system32\tbs.dll
\Windows\system32\TpmCoreProvisioning.dll
\Windows\system32\UIAutomationCore.dll
\Windows\system32\wbem
\Windows\system32\Wecapi.dll
\Windows\system32\Wecsvc.dll
\Windows\system32\Wecutil.exe
\Windows\system32\Wevtfwd.dll
\Windows\system32\Windows.ApplicationModel.dll
\Windows\system32\WindowsPowerShell
\Windows\system32\Winrm
\Windows\system32\Winrm.cmd
\Windows\system32\Winrm.vbs
\Windows\system32\Winrs.exe
\Windows\system32\Winrscmd.dll
\Windows\system32\Winrshost.exe
\Windows\system32\Winrsmgr.dll
\Windows\system32\Winrssrv.dll
\Windows\system32\WinTypes.dll
\Windows\system32\wmitomi.dll
\Windows\system32\Wsmanconfig_schema.Xml
\Windows\system32\Wsmanhttpconfig.exe
\Windows\system32\Wsmanmigrationplugin.dll
\Windows\system32\Wsmauto.dll
\Windows\system32\Wsmplpxy.dll
\Windows\system32\Wsmprovhost.exe
\Windows\system32\Wsmpty.xsl
\Windows\system32\Wsmres.dll
\Windows\system32\Wsmsvc.dll
\Windows\system32\Wsmtxt.xsl
\Windows\system32\Wsmwmipl.dll
\windows\System32\wuaueng.dll
\Windows\SystemResources\propsys.dll.mun

[AddFiles6432]
\Program Files (x86)\WindowsPowerShell
\Windows\SysWOW64\??-??\mi.dll.mui
\Windows\SysWOW64\??-??\mispace.dll.mui
\Windows\SysWOW64\??-??\miutils.dll.mui
\Windows\SysWOW64\??-??\PSModuleDiscoveryProvider.dll.mui
\Windows\SysWOW64\??-??\Pwrshplugin.dll.mui
\Windows\SysWOW64\??-??\storagewmi.dll.mui
\Windows\SysWOW64\??-??\TpmCoreProvisioning.dll.mui
\Windows\SysWOW64\??-??\UIAutomationCore.dll.mui
\Windows\SysWOW64\??-??\Wecsvc.dll.mui
\Windows\SysWOW64\??-??\Wecutil.exe.mui
\Windows\SysWOW64\??-??\Wevtfwd.dll.mui
\Windows\SysWOW64\??-??\Windows.ApplicationModel.dll.mui
\Windows\SysWOW64\??-??\Winrs.exe.mui
\Windows\SysWOW64\??-??\WinTypes.dll.mui
\Windows\SysWOW64\??-??\wmitomi.dll.mui
\Windows\SysWOW64\??-??\Wsmres.dll.mui
\Windows\SysWOW64\??-??\Wsmsvc.dll.mui
\windows\SysWOW64\amsi.dll
\Windows\SysWOW64\Appxsip.dll
\windows\SysWOW64\clbcatq.dll
\Windows\SysWOW64\mi.dll
\Windows\SysWOW64\Microsoft.Management.Infrastructure.Native.Unmanaged.dll
\Windows\SysWOW64\mispace.dll
\Windows\SysWOW64\miutils.dll
\Windows\SysWOW64\mscoree.dll
\windows\SysWOW64\NgcRecovery.dll
\Windows\SysWOW64\OpcServices.dll
\windows\SysWOW64\propsys.dll
\Windows\SysWOW64\PSModuleDiscoveryProvider.dll
\Windows\SysWOW64\Pwrshplugin.dll
\Windows\SysWOW64\storagewmi.dll
\Windows\SysWOW64\tbs.dll
\Windows\SysWOW64\TpmCoreProvisioning.dll
\Windows\SysWOW64\UIAutomationCore.dll
\Windows\SysWOW64\wbem
\Windows\SysWOW64\Wecapi.dll
\Windows\SysWOW64\Wecsvc.dll
\Windows\SysWOW64\Wecsvc.dll
\Windows\SysWOW64\Wecutil.exe
\Windows\SysWOW64\Wevtfwd.dll
\Windows\SysWOW64\Windows.ApplicationModel.dll
\Windows\SysWOW64\WindowsPowerShell
\Windows\SysWOW64\winrm
\Windows\SysWOW64\Winrm.cmd
\Windows\SysWOW64\Winrm.vbs
\Windows\SysWOW64\Winrs.exe
\Windows\SysWOW64\Winrscmd.dll
\Windows\SysWOW64\Winrshost.exe
\Windows\SysWOW64\Winrsmgr.dll
\Windows\SysWOW64\Winrssrv.dll
\Windows\SysWOW64\WinTypes.dll
\Windows\SysWOW64\wmitomi.dll
\Windows\SysWOW64\Wsmanconfig_schema.Xml
\Windows\SysWOW64\Wsmanhttpconfig.exe
\Windows\SysWOW64\Wsmanmigrationplugin.dll
\Windows\SysWOW64\Wsmauto.dll
\Windows\SysWOW64\Wsmplpxy.dll
\Windows\SysWOW64\Wsmprovhost.exe
\Windows\SysWOW64\Wsmpty.xsl
\Windows\SysWOW64\Wsmres.dll
\Windows\SysWOW64\Wsmsvc.dll
\Windows\SysWOW64\Wsmtxt.xsl
\Windows\SysWOW64\Wsmwmipl.dll
\windows\SysWOW64\wuaueng.dll

[Add_Registry]
RegWrite,HKLM,0x1,Tmp_Software\Microsoft\PowerShell\1\ShellIds\Microsoft.PowerShell,ExecutionPolicy,%pScrollBox1%
If,%Architecture%,Equal,x64,RegWrite,HKLM,0x1,Tmp_Software\Wow6432Node\Microsoft\PowerShell\1\ShellIds\Microsoft.PowerShell,ExecutionPolicy,%pScrollBox1%
RegWrite,HKLM,0x2,"Tmp_System\ControlSet001\Control\Session Manager\Environment",Path,"#$pSystemRoot#$p\system32;#$pSystemRoot#$p;#$pSystemRoot#$p\System32\Wbem;#$pSystemRoot#$p\System32\WindowsPowerShell\v1.0\"

[Add_Shortcuts]
If,%pCheckBox1%,Equal,True,Begin
Set,%StartMenuFolder_TextBoxV%,%StartMenuFolder_TextBox%
If,%StartMenuFolder_TextBoxV%-,Equal,-,Set,%StartMenuFolder_TextBoxV%,%dfFolderSM%
Set,%Startmenu_Folder_Name%,%StartMenuFolder_TextBoxV%
If,Not,%pTextBox2%,Equal,,AddShortcut,StartMenu,%StartMenuFolder_TextBoxV%,%SystemRoot%\System32\WindowsPowerShell\v1.0\powershell_ISE.exe,%pTextBox2%
If,Not,%pTextBox3%,Equal,,AddShortcut,StartMenu,%StartMenuFolder_TextBoxV%,%SystemRoot%\System32\WindowsPowerShell\v1.0\powershell.exe,%pTextBox3%
End

[AuthorEncoded]
PowerShell.jpg=2025,2700
Logo=PowerShell.jpg

[EncodedFile-AuthorEncoded-PowerShell.jpg]
lines=0
0=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

[EncodedFolders]
Folder

[Folder]

