[Main]
Title=MS Visual C++ Runtime
Type=XPEPlugin
Description=Allows You To Run Programs Created With Microsoft Visual C++
Author=KYHI
Date=2020.01.08
Credits=Homes32, ChrisR, JFX
Contact=
Version=016
Level=5
Download_Level=2
Selected=False
Mandatory=False
NoWarning=False
History016=KYHI - KYHI - Updated C++ 2005-2019 - 2020.01.08

[Variables]
%ContainerFile%=%ScriptDir%\VcRunTimes_XPE_File.script
Extract=Run,%ScriptFile%,PExtract

[Interface]
BVL_Container=Shortcut_Bevel,1,12,0,14,406,187
TXT_Ver=RuntimeVer.txt,1,6,265,20,135,175
LBL_Runtimes="Add the following Runtimes:",1,1,10,23,185,18,8,Bold
LBL_VC8="Visual C++ 2005 (8.0)",1,1,18,50,145,18,8,Normal,"__Full x86: 5MB / x64: 6MB / Total: 11MB"
SB_VC8="Embedded                   0",1,4,165,48,84,21,"Embedded                   0","Full                      1","__Full x86: 5MB / x64: 6MB / Total: 11MB"
LBL_VC9="Visual C++ 2008 (9.0)",1,1,18,75,145,18,8,Normal,"__Full x86: 10MB / x64: 12MB / Total: 22MB"
SB_VC9="Embedded                   0",1,4,165,73,84,21,"Embedded                   0","Full                      1","__Full x86: 10MB / x64: 12MB / Total: 22MB"
LBL_VC10="Visual C++ 2010 (10.0)",1,1,18,100,145,18,8,Normal,"__Full x86: 12MB / x64: 15MB / Total: 27MB"
SB_VC10="Full                      1",1,4,165,98,84,21,"None                   0","Full                      1","__Full x86: 12MB / x64: 15MB / Total: 27MB"
LBL_VC11="Visual C++ 2012 (11.0)",1,1,18,125,145,18,8,Normal,"__Full x86: 11MB / x64: 14MB / Total: 25MB"
SB_VC11="Full                      1",1,4,165,123,84,21,"None                   0","Full                      1","__Full x86: 11MB / x64: 14MB / Total: 25MB"
LBL_VC12="Visual C++ 2013 (12.0)",1,1,18,150,145,18,8,Normal,"__Full x86: 11MB / x64: 14MB / Total: 25MB"
SB_VC12="Full                      1",1,4,165,148,84,21,"None                   0","Full                      1","__Full x86: 11MB / x64: 14MB / Total: 25MB"
LBL_VC14="Visual C++ 2015-19 (14.0)",1,1,18,175,145,18,8,Normal,"__Full x86: 13MB / x64: 15MB / Total: 28MB"
SB_VC14="Full                      1",1,4,165,173,84,21,"None                   0","Full                      1","__Full x86: 13MB / x64: 15MB / Total: 28MB"
LBL_Warning="Warning: ",1,1,2,210,205,18,8,Normal
LBL_WarnTxt2="Disabling components of this Plugin may cause your programs to stop working.",1,1,2,225,390,18,8,Normal
LBL_WarnTxt3="Do not disable individual runtimes unless you know what you are doing!",1,1,2,240,390,18,8,Normal
HomePage_WebLabel="Home Page",1,10,338,0,54,18,https://support.microsoft.com/en-us/help/2977003/the-latest-supported-visual-c-downloads

[Process]
If,Not,ExistFile,%ContainerFile%,Exit,"'%ScriptTitle%' Container File Missing %ContainerFile%"
StrFormat,RIGHT,%SB_VC8%,1,%VC8%
StrFormat,RIGHT,%SB_VC9%,1,%VC9%
StrFormat,RIGHT,%SB_VC10%,1,%VC10%
StrFormat,RIGHT,%SB_VC11%,1,%VC11%
StrFormat,RIGHT,%SB_VC12%,1,%VC12%
StrFormat,RIGHT,%SB_VC14%,1,%VC14%
//--
//- Install VC++ x86 Runtime For x86 Build or For x64 Build With Wow64 Support.
//Set,%x86Runtime%,False
//If,%Architecture%,Equal,x86,Set,%x86Runtime%,True
//If,%Architecture%%WoW64Support%,Equal,x64True,Set,%x86Runtime%,True
//-
If,ExistDir,%GTemp%\VC++,Shellexecute,Hide,cmd.exe,"/C rd /s /q #$q%GTemp%\VC++#$q"
If,ExistDir,%GTemp%\VC++,DirDeleteQ,%GTemp%\VC++
DirMake,%GTemp%\VC++
// Visual C++ 2005 (0=Embedded, 1=Full)
If,%VC8%,Equal,1,Run,%ScriptFile%,ProcessVC8
// Visual C++ 2008 (0=Embedded, 1=Full)
If,%VC9%,Equal,1,Run,%ScriptFile%,ProcessVC9
// Visual C++ 2010 (0=None, 1=Full)
If,%VC10%,Equal,1,Run,%ScriptFile%,ProcessVC10
// Visual C++ 2012 (0=None, 1=Full)
If,%VC11%,Equal,1,Run,%ScriptFile%,ProcessVC11
// Visual C++ 2013 (0=None, 1=Full)
If,%VC12%,Equal,1,Run,%ScriptFile%,ProcessVC12
// Visual C++ 2017 (0=None, 1=Full)
If,%VC14%,Equal,1,Run,%ScriptFile%,ProcessVC14

[ProcessVC8]
Set,%x86Runtime%,False
If,%Architecture%,Equal,x86,Set,%x86Runtime%,True
If,%Architecture%%WoW64Support%,Equal,x64True,Set,%x86Runtime%,True
//
Echo,"Installing Visual C++ 2005..."
If,%Architecture%,Equal,x64,Begin
If,%x86Runtime%,Equal,True,Extract,x86,VC8.7z,%GTarget_Win%\SysWOW64
Extract,x64,VC8.7z,%GTarget_Win%\System32
End
Else,Extract,x86,VC8.7z,%GTarget_Win%\System32

[ProcessVC9]
Set,%x86Runtime%,False
If,%Architecture%,Equal,x86,Set,%x86Runtime%,True
If,%Architecture%%WoW64Support%,Equal,x64True,Set,%x86Runtime%,True
//
Echo,"Installing Visual C++ 2008..."
If,%Architecture%,Equal,x64,Begin
If,%x86Runtime%,Equal,True,Extract,x86,VC9.7z,%GTarget_Win%\SysWOW64
Extract,x64,VC9.7z,%GTarget_Win%\System32
End
Else,Extract,x86,VC9.7z,%GTarget_Win%\System32

[ProcessVC10]
Set,%x86Runtime%,False
If,%Architecture%,Equal,x86,Set,%x86Runtime%,True
If,%Architecture%%WoW64Support%,Equal,x64True,Set,%x86Runtime%,True
//
Echo,"Installing Visual C++ 2010..."
If,%Architecture%,Equal,x64,Begin
If,%x86Runtime%,Equal,True,Extract,x86,VC10.7z,%GTarget_Win%\SysWOW64
Extract,x64,VC10.7z,%GTarget_Win%\System32
End
Else,Extract,x86,VC10.7z,%GTarget_Win%\System32

[ProcessVC11]
Set,%x86Runtime%,False
If,%Architecture%,Equal,x86,Set,%x86Runtime%,True
If,%Architecture%%WoW64Support%,Equal,x64True,Set,%x86Runtime%,True
//
Echo,"Installing Visual C++ 2012..."
If,%Architecture%,Equal,x64,Begin
If,%x86Runtime%,Equal,True,Extract,x86,VC11.7z,%GTarget_Win%\SysWOW64
Extract,x64,VC11.7z,%GTarget_Win%\System32
End
Else,Extract,x86,VC11.7z,%GTarget_Win%\System32

[ProcessVC12]
Set,%x86Runtime%,False
If,%Architecture%,Equal,x86,Set,%x86Runtime%,True
If,%Architecture%%WoW64Support%,Equal,x64True,Set,%x86Runtime%,True
//
Echo,"Installing Visual C++ 2013..."
If,%Architecture%,Equal,x64,Begin
If,%x86Runtime%,Equal,True,Extract,x86,VC12.7z,%GTarget_Win%\SysWOW64
Extract,x64,VC12.7z,%GTarget_Win%\System32
End
Else,Extract,x86,VC12.7z,%GTarget_Win%\System32

[ProcessVC14]
Set,%x86Runtime%,False
If,%Architecture%,Equal,x86,Set,%x86Runtime%,True
If,%Architecture%%WoW64Support%,Equal,x64True,Set,%x86Runtime%,True
//
Echo,"Installing Visual C++ 2015-2019..."
If,%Architecture%,Equal,x64,Begin
If,%x86Runtime%,Equal,True,Extract,x86,VC14.7z,%GTarget_Win%\SysWOW64
Extract,x64,VC14.7z,%GTarget_Win%\System32
End
Else,Begin
Extract,x86,VC14.7z,%GTarget_Win%\System32
End
DirDeleteQ,%GTemp%\VC++

[PExtract]
// #1Encoded Folder (x86|x64) - #2 Archive (ex: VC14.11.7z) - #3 Target Folder (ex: %GTarget_Win%\System32)
ExtractFile,%ContainerFile%,#1,#2,%GTemp%\VC++\#1
ShellExecute,Hide,%GTools%\7z.exe,"x #$q%GTemp%\VC++\#1\#2#$q -y -o#$q#3#$q"

[AuthorEncoded]
Visual_C++_Icon.jpg=4673,6231
Logo=Visual_C++_Icon.jpg

[EncodedFile-AuthorEncoded-Visual_C++_Icon.jpg]
lines=1
0=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
1=ojIqWCJJ0HDamN+AzE+qDZecaEV3ek2yyC2A7/cQPnaTzoLBLUyi9c7sK1Zi3+tBHW1Vnt18f5cF4ZyxRrx0X9d53ZzVz7sgW24sH7HhYqJUHcd018Y0KTTlxgIGPmfNegaPPUk24rgQcKX/FP0aqiDwJE7/sFw/uiTCeP3PwFIne/vNRefcV9ko48lXPwWfDPnamA10bb41PvLtgNbTgatq5wk568cuRMUohgcLA1kc+/ElElwc7zLTPXbNIFr7dqsB0VTXctI3lFluqKDhU0gO7aHt0gHTjVDRXjcWZ7XtkVTJC/PaHikrSQ0T+iJa1D4IyRSp/sI/PNqCwbPbZY1Jk9YHQNDYLjWK888eFCJh3SM7HZ3t4bXecuEOa62eMZSJK0zjgV3TqKhJQjv6zJxzuLTF8AWqLNK3xaH+rUbhbFf0jnb+DwVhoVrckioZPFyquX1hat2dyhHtE7kV8xjmwHcrjXdZLR/sn9awpdgQkVRevqK6DSG3JDf+3/WWr1aMkZeDXPk0fgjq+lMkOopJv3TN99P5P7a5uaj/qmkDw4bZ4xcrGzwHewL8mBObkqeTX1sUAzKG6tAEsggZ1tnlel9OHeRlQ7pVUYvX/QGdKNtC5VYzZS6hudIj5DT5ZUxZHf1DQokowJxdiMIW2KH3B2MhdsSJ+Q+DRah7XYrc4n33DF8iNoRzOswu+6cb2y9duwKz/5nM5uHs3ci9ldoxJxb0hFuwapax6+be/Sir4pzmodEsQTfUdyokEXpaFuWWWfazgY8vNeVlCJOJfEsArGm/yk/z6+fUmLyZmVQ48rHo1BujAn908j7eMjue4jjVB8LetSoZKWcTnl6tBBc5+BllEX0JkyCY47llknNDw9EOI0Roo0znU3I/sjZxrHrKoNmV5FozIzGeOxiNhIG9AFgGkRz9HTZ0YpFPzCDk7oJC5IZ2KqxNalQpZKd/pk3/mHTa+M7GrmVLZYZDllw79HixKkiUp47aS0XvxQf1liq8M02tmj0joKSiv087XngsZV5fR21eNDgjSZPoJghobAz4RPxPu25JXDviijQXlR0LHJ0wZmk9Qodp3N7NGYY3OXwP6zKDRYefg824HeYH4xf+GvGmtUK2nt17629poLM+xeipPBc9fG0POq4/M8bY7E90dNSJX8j+T7/GR6+tO7In22wiSjRUMPA0J3DcIQ7CXIcp/2EWDjhXRJeroQSdRrJ+DZsdgW1hGaGmG9ojR9I1EwjpWx7qP2Vl3PH/qarJsWiHMg6wGCcIvpuNZtL1fUzyhCjNLfwU9jMizGd/ZnjFP6iSRJo2AomyvXKzhh98ranws5HvXn62Zsgh7fdvNvw4W0URvbWoQjoivJoDbamZRYAwOR2VKuuhiMf0vsP9khVtQUjwZEyG5/6oVkeoCy6vl5HT/zPqKsY1fcU9sOP6U5Czrv6nIRWLB6//VpzBWfoySwGYHfoi3XX/DK6qgrlvTtrqoJFPdpaH03Vu0vjGKaWJbQNpL4mkSPPyVmkryqzxRJZf41X2G6v4bIdDPyr1UWpxqjjkPSnDxiMT+9WjvkXZUNR8IpZQLB8Hf7Vrz9UV6xXWxY+UQIDwbMu/oY+Cd+KEFF2na75T0/tDV9ZmyGbkqiT58iy+ZG9OQn54hvsjIYcOrnmD24kaliIlUXRzxfl0uBW+M4eeWkGsQaN/KoBtOvG9u7WoNk0nfbKRVznuUwVZG4g8kXEzPLy+9djUksFXIl7W+RYDPlvR1hQArR/i/8aQNuyjLL0+gptDF/Onp4qjzvlCs+423fdGjdsGVKKZ/i9/rVr81D21H4W0RvkktFtAzpMdYhuNIHMwKH1/hGvJs6fB+wy+gdyux19/nwcmhYa97P3od1Aoq1SoaCdgwn6Qiy/QCusf3M+sbV9IE1RdhnJ9+CVFNpDvsqXxLi0H3Dot4XJSo5VauhJmlk0rrymvyhd1XBLgbE+uQDVmEOzM2eBoaAGBMqTNOFWHVTLSXNK4xK3BhCNnsl+tgQqRbQGxfz/wH4RxQkeJwTDsssLk3MiXfW1o73TM7P08sqSGcYBSMGXBWC0O8Esct/bVT1Z2ACALlsCqne9BOPAQAAAAIAAAAvAAAA7hEAAAAAAAABAAAAAAAAAAAAAAA

[InterfaceEncoded]
RuntimeVer.txt=158,211

[EncodedFolders]
Folder
InterfaceEncoded

[EncodedFile-InterfaceEncoded-RuntimeVer.txt]
lines=0
0=eJwlyb0NgCAQBtDehB2c4PLd8b+GhRtQUIiJ6P4eUL6842tvvcp+lqfXu3WzmS0RyCNKHMgKq8gDDJWD8BKrAsNiSuaFsORIPEnySGR/aDUTWXic4wsqzSvJzE0NSy3SK6koYRgFIwukQukgHPILErcGMTABACxUCG9YeE0MAQAAAAIAAAAoAAAAUgAAAAAAAAABAAAAAAAAAAAAAAA

