[Main]
Title=One Loupe
Type=XPEPlugin
Description=(v4.5.5.0) One Loupe is a Simple and easy to use, the small Magnifier is always ready when you need it to view all fine details, even the small print in the I-Net to decipher.
Author=KYHI
Date=2020.04.09
Credits=TheOven.org Forum
Contact=
Version=001
Level=5
Download_Level=2
Selected=False
Mandatory=False
NoWarning=False
History001=KYHI Initial XPE Packed Plugin Created 2020.04.09
History002=

[Interface]
Shortcut_Bevel=Shortcut_Bevel,1,12,4,6,133,121
Desktop_CheckBox="Desktop Shortcut",1,3,10,10,122,18,False,"__Add Desktop Shortcut"
StartMenu_CheckBox="Start Menu Shortcut",1,3,10,28,122,18,True,"__Add Start Menu Shortcut"
TaskBpin_CheckBox="Pin To TaskBar",1,3,10,46,122,18,False,"__Add Pin To Taskbar Shortcut"
StartMpin_CheckBox="Pin To StartMenu",1,3,10,64,122,18,False,"__Add Pin To StartMenu Shortcut"
StartMenuFolder_TextBox="Start Menu Folder:",1,0,10,100,121,18,,"__Start Menu Folder Name"
RunFromWhere_ScrollBox="Run From USB",1,4,145,6,104,21,"Run From USB","Run From RAM"
Image_Software=OneLoupe4848.ico,1,5,145,35,48,48
Button_Launch_Program=Launch,1,8,10,188,119,25,Launch_Program,Launch.bmp,False,_Launch_Program_,False,"__Click Here To Launch Program"
HomePage_WebLabel="Home Page",1,10,338,6,55,18,https://www.softwareok.com/?seite=Microsoft/OneLoupe/History
Update_Container_Button=U,0,8,540,4,14,14,Update_Container,0,False,"__Update-Encode Container File"
Lang_Bevel=Lang_Bevel,1,12,4,134,133,44
Lang_TextLabel=Language:,1,1,12,137,55,18,8,Normal
Lang_ScrollBox="English                             1 ",1,4,10,153,119,21,"Arabic                              6 ","Dutch                               10","English                             1 ","French                              8 ","German                              0 ","Greek                               5 ","Hungarian                           14","Italian                             15","Japanese                            18","Korean                              17","Persian                             16","Polish                              3 ","Russian                             9 ","Serbian                             13","Simplified Chinese                  11","Slovenian                           7 ","Spanish                             4 ","Swedish                             2 ","Traditional Chinese                 12"

[Variables]
%ProgramTitle%=One Loupe
%ProgramExe%=OneLoupe.exe
%ProgramExex64%=OneLoupe_x64.exe
%ProgramFolder%=OneLoupe
%ProgramFolderx64%=OneLoupe_x64
%SetupFile%=OneLoupe.zip
%SetupFilex64%=OneLoupe_x64.zip
%SetupURL%=https://www.softwareok.com/Download/OneLoupe.zip
%SetupURLx64%=https://www.softwareok.com/Download/OneLoupe_x64.zip
%ProvideFiles%=%ProgCache%\%ProgramFolder%
%FileContainer%=%ScriptDir%\OneLoupe_XPE_File.Script

[Process]
Echo,"Processing %ScriptTitle%..."
If,Not,ExistFile,%FileContainer%,Exit,"%FileContainer% Container File Not Found"
If,%RunFromWhere_ScrollBox%,Equal,"Run From RAM",RunFromRAM
If,%Architecture%,Equal,x64,Run,%ScriptFile%,PluginSetx64
//--
AddVariables,%ProjectDir%\script.project,TargetBasePath
//--
Run,%ScriptFile%,Extract
//--
If,ExistDir,%Target_Prog%\%ProgramFolder%,DirDeleteQ,%Target_Prog%\%ProgramFolder%
If,Not,ExistDir,%Target_Prog%,DirMake,%Target_Prog%
DirCopy,%GTemp%\%ProgramFolder%\%ProgramFolder%,%Target_Prog%
//--
Run,%ScriptFile%,Add_Shortcuts
//--
ExtractSectionFiles,%ScriptFile%,AddFiles
//--
Run,%ScriptFile%,Add_INI

[AddFiles]
\Windows\System32\Magnification.dll

[Add_INI]
Echo,"Writing %ScriptTitle% Settings..."
StrFormat,RIGHT,%Lang_ScrollBox%,2,%VarResult%
Set,%t%,%TargetAppDataRoaming%\OneLoupe\OneLoupe.ini
If,Existfile,%t%,FileDeleteQ,%t%
FileCreateBlank,%t%
IniWrite,%t%,Program,lng,%VarResult%

[Add_Shortcuts]
If,%Desktop_CheckBox%,Equal,True,AddShortcut,Desktop
If,%StartMenu_CheckBox%,Equal,True,AddShortcut,StartMenu,%StartMenuFolder_TextBox%
If,%StartMpin_CheckBox%,Equal,True,AddPin,StartMenu
If,%TaskBpin_CheckBox%,Equal,True,AddPin,TaskBar

[Extract]
Set,%SetupContainerSize%,""
IniRead,%FileContainer%,Folder,%SetupFile%,%SetupContainerSize%
If,%SetupContainerSize%-,Equal,-,Run,%ScriptFile%,Update_Container
//--
Echo,"Extracting %ScriptTitle% Setup File..."
If,ExistDir,%GTemp%\%ProgramFolder%,DirDeleteQ,%GTemp%\%ProgramFolder%
DirMake,%GTemp%\%ProgramFolder%
ExtractFile,%FileContainer%,Folder,%SetupFile%,%GTemp%\%ProgramFolder%
ShellExecute,Hide,%GTools%\7z.exe,"x #$q%GTemp%\%ProgramFolder%\%SetupFile%#$q -y -o#$q%GTemp%\%ProgramFolder%\%ProgramFolder%#$q"

[PluginSetx64]
Set,%ProgramExe%,%ProgramExex64%
Set,%ProgramFolder%,%ProgramFolderx64%
Set,%SetupFile%,%SetupFilex64%
Set,%SetupURL%,%SetupURLx64%

[Launch_Program]
If,%HostOSArch%,Equal,x64,Run,%ScriptFile%,PluginSetx64
Run,%ScriptFile%,Extract
//OpenDir,%GTemp%\%ProgramFolder%\%ProgramFolder%
Start,,%ProgramExe%,,%GTemp%\%ProgramFolder%\%ProgramFolder%

[Update_Container]
Echo,"The Container Files Is Being Updated... Please Wait.."
If,ExistDir,%ProvideFiles%,DirDeleteQ,%ProvideFiles%
If,Not,ExistDir,%ProvideFiles%,DirMake,%ProvideFiles%
If,%Architecture%,Equal,x64,Run,%ScriptFile%,PluginSetx64
Download,%ProvideFiles%\%SetupFile%,%SetupURL%,NoExitOnError
If,Not,ExistFile,%ProvideFiles%\%SetupFile%,EchoExtended,"Error: %SetupFile% has not been downloaded.",Warn,,Message,5,Exit
Encode,%Filecontainer%,Folder,%ProvideFiles%\%SetupFile%
DirDeleteQ,%ProvideFiles%

[AuthorEncoded]
OneLoupe4848.ico=1847,2463
Logo=OneLoupe4848.ico

[EncodedFile-AuthorEncoded-OneLoupe4848.ico]
lines=0
0=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

[InterfaceEncoded]
OneLoupe4848.ico=1847,2463
Launch.bmp=913,1218

[EncodedFile-InterfaceEncoded-OneLoupe4848.ico]
lines=0
0=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

[EncodedFile-InterfaceEncoded-Launch.bmp]
lines=0
0=eJxN0WtMFFcUAGCM/W/SXzSxaZOmTX8YtdLSJk1jQsIPpUZNSGMTWk1tKvFVMDVGCaIWRKWGgrLaRbq4AruwT92XWoshUVAhKtFAYVmWZXdgdmdnZ+beedy587gdXJr05JyTm3O/5J7kVuywrS15E+VWfWzVOqvetmpNSemb+b7V+/8HI5vLgggx+K73x2/sP1Tb9+QBRXEwrxAG4qyk0lClgcxAhRBi+RN/L1T9efTM+OUQgZ38qyvceHW0YWNrVe2z7M/j7OGXuYNP0keD443PmcHnScvvdbbXPTz4gtBVd2sqQ19vi+yqffHb7uBPW7tPHM+QujjfEOdqwzORR8PR0IDlNzeXX50fmCTshp7yj65vXt/xbmVg//6RptIDa05myeEptmGG/d73OjI3N70wY/myXze1TfXO6sInPV+WXn7vw65Pz0LSkHy67tuSJo7Uz3Dn4uze4GSMQs8oYPmd16p33N3zWX/F5wNbKz3bym5u6dZIa+r+O4fWnufI8Vm+dY7bd2fyr2X5ZZqx/BGvw5/wD9H3jzz6pe5xfWcieo/I2/u/qLhxqjlLTs0LzQnu2IPpO6zqja/4jleZGm99cMo3QWanyNI0EWsCu8u6djUmwOkkbEyClhRoHk20zxUuTaQs75wHLlY8FLF91bLlgwNvbTr9flVf04UMOk+pZ5LCSqbAxTgT/mcJIGz53oVCRCFejUTISt4mpEckXTncRsELadCyCFsWhba0NEbxxf9yLhRCkuli8S3esBc0O610MehqDlm9dRFepJQ2ClxKwdF0oehdiyAsmR6o9YtGH685AHEUkJ3F13JKO610LMPfl8ROGo1luKJ3Z8CwSvyi7gG6W8C3CoqTQw5e6ykgW06x5dCVnGzLCKOZ1X2GKPAAkaho+CTNJ+o+qLtFw5lXbuZRd16+zqAbednBoKdLQtEPUmAYkduyFlRwUMbWYh5Bc0tmn/WWbHQzkp03/qClCRoWvUdQR1RzBJv3kBlTjZhihJDmFbWAZAwJ2MXjQQH7eXWCWfVuWgwDHBNxTDKioh6GWgjggIADvOrnsItTvSyyZ+Wx7KoHmlFM0TBF3YS6aZ3hf0Pe6lhnNUPWjKL/F4rXcD14nOPySSzNS87QS8otYBgFIw9MY4bQ7szY5SXNdJ4zMAEARyYGGuVhjnsBAAAAAgAAACYAAABHAwAAAAAAAAEAAAAAAAAAAAAAAA


[EncodedFolders]
Folder


[Folder]

