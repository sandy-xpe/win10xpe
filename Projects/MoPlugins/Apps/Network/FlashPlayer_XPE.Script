[Main]
Title=Adobe Shockwave Flash Player
Type=XPEPlugin
Description=Plugin Adds Adobe Shockwave Flash Player NPAPI Version 32.0.0.363
Author=Adobe
Date=2019.10.07
Credits=Mikka, Kyhi, Lancelot
Contact=http://TheOven.org
Version=002
Level=5
Download_Level=2
Selected=False
Mandatory=False
NoWarning=False
History001=KYHI Initial XPE Packed Plugin Created 2019.06.08
History002=KYHI - Fixed Missing Quotes - 2019.10.07

[Info]
//[InterFace]
If,%FlashPlayer_Checkbox%,Equal,True,Run,%ScriptFile%,FlashPlayer
//[FlashPlayer]
If,ExistFile,%ScriptDir%\FlashPlayer_XPE.Script,Exec,%ScriptDir%\FlashPlayer_XPE.Script,Process
Else,Echo,"Adobe Flash Plugin Required To Enable Flash Player NPAPI",Warn
//--

[InterFace]
HomePage_WebLabel="Home Page",1,10,338,6,55,18,https://www.adobe.com/products/flashplayer.html
Interface_Default_Button=R,1,8,519,-1,14,14,Settings_Default,0,False,"__Reset Interface To Empty Values"
Update_Container_Button="Update Flash Player Container Files",1,8,8,40,221,25,Update_Container,0,False,"__Step 3 > Update Flash Player Container Files."
pButton1="Download Latest Flash Player Installer",1,8,8,4,221,25,Download,0,False,"__Step 1 > Download Latest Flash Player Installer."
pTextLabel1="Adobe Flash Player Installer Version:",1,1,8,80,180,18,8,Normal
pTextLabel2="Flash Player Container File Version:",1,1,8,105,180,18,8,Normal
InstallerVer=32.0.0.363,1,1,190,80,74,18,8,Bold
ContainerVer=32.0.0.363,1,1,190,105,74,18,8,Bold

[Variables]
%ProgramFolder%=Flash_Player_Installer
%ProvideFiles%=%ProgCache%\%ProgramFolder%
%SetupFile%=install_flash_player.exe
%SetupURL%=https://fpdownload.macromedia.com/pub/flashplayer/latest/help/install_flash_player.exe
%ProgramEXE%=FlashInstaller_XPE.bat

[Process]
If,%Architecture%,Equal,x86,Begin
Set,%FlashPackage%,%ScriptDir%\FlashPlayer86_XPE_File.script
Set,%FlashFolder%,%GTarget_Sys%\Macromed\Flash
Set,%FlashPackageFile%,NPSWF32.dll
Set,%FlashCompressFile%,NPSWF32.7z
Set,%PEFlashFolder%,X:\Windows\System32\Macromed\Flash
Run,%ScriptFile%,Process_Container
End
//--
If,%Architecture%,Equal,x64,Begin
Set,%FlashPackage%,%ScriptDir%\FlashPlayer64_XPE_File.script
Set,%FlashFolder%,%GTarget_Sys%\Macromed\Flash
Set,%FlashPackageFile%,NPSWF64.dll
Set,%FlashCompressFile%,NPSWF64.7z
Set,%PEFlashFolder%,X:\Windows\System32\Macromed\Flash
Run,%ScriptFile%,Process_Container
End
//
If,%Architecture%%WoW64Support%,Equal,x64True,Begin
Set,%FlashPackage%,%ScriptDir%\FlashPlayer86_XPE_File.script
Set,%FlashFolder%,%GTarget_Win%\SysWOW64\Macromed\Flash
Set,%FlashPackageFile%,NPSWF32.dll
Set,%FlashCompressFile%,NPSWF32.7z
Set,%PEFlashFolder%,X:\Windows\SysWOW64\Macromed\Flash
Run,%ScriptFile%,Process_Container
End
//-
ExtractSectionFiles,%ScriptFile%,AddFiles
If,%Architecture%%WOW64%,Equal,x64True,ExtractSectionFiles,%ScriptFile%,AddFiles6432
If,ExistDir,%ProvideFiles%,DirDeleteQ,%ProvideFiles%

[Process_Container]
If,Not,ExistFile,%FlashPackage%,Exit,"%FlashPackage% Container File Not Found"
//--
Set,%SetupContainerSize%,""
IniRead,%FlashPackage%,Folder,%FlashCompressFile%,%SetupContainerSize%
If,%SetupContainerSize%-,Equal,-,EchoExtended,"%FlashPackageFile% Does Not Exist - You Must Download Installer & Encode %FlashPackageFile%.",,,Message,4,Exit
//--
If,ExistFile,%FlashFolder%\%FlashPackageFile%,FileDeleteQ,%FlashFolder%\%FlashPackageFile%
Run,%FlashPackage%,FlashPackage_Extract,%FlashPackage%,,%FlashPackageFile%,%FlashFolder%
Run,%FlashPackage%,FlashPackage_Registry,%FlashPackage%,%FlashPackageFile%,%PEFlashFolder%

[AddFiles]
\Windows\System32\dinput8.dll
\Windows\System32\dsound.dll
\Windows\System32\mscms.dll
\Windows\System32\??-??\dinput8.dll.mui
\Windows\System32\??-??\dsound.dll.mui
\Windows\System32\??-??\mscms.dll.mui

[AddFiles6432]
\Windows\SysWOW64\dinput8.dll
\Windows\SysWOW64\dsound.dll
\Windows\SysWOW64\mscms.dll

[Download]
If,ExistDir,%ProvideFiles%,DirDelete,%ProvideFiles%
DirMake,%ProvideFiles%
Download,%ProvideFiles%\%SetupFile%,%SetupURL%
Retrieve,FileVersion,%ProvideFiles%\%SetupFile%,%InstallerVer%
IniWrite,%ScriptFile%,InterFace,InstallerVer,"%InstallerVer%,1,1,190,80,74,18,8,Bold"
System,REFRESHINTERFACE
If,%InstallerVer%,Bigger,%ContainerVer%,Begin
Run,%ScriptFile%,GetFlashLib
Message,"Adobe Shockwave Flash Player Needs To Be Updated#$xRun > %ProgramEXE% < To Install And Gather Files#$xUse Update Container File Button To Encode Plugin"
//Start,,,,%ProvideFiles%
OpenDir,%ProvideFiles%
End

[GetFlashLib]
Set,%vw%,%ProvideFiles%\%ProgramEXE%
If,ExistFile,%vw%,FileDeleteQ,%vw%
FileCreateBlank,%vw%
TXTAddLine,%vw%,"",Append
TXTAddLine,%vw%,"@echo off",Append
TXTAddLine,%vw%,"echo. Installing Adobe Flash Player... Please Wait..",Append
TXTAddLine,%vw%,"cd /d #$q%~dp0#$q",Append
TXTAddLine,%vw%,"%SetupFile% -install",Append
TXTAddLine,%vw%,"del /q /f NPSWF32.dll",Append
TXTAddLine,%vw%,"del /q /f NPSWF64.dll",Append
TXTAddLine,%vw%,"xcopy /y #$pWinDir#$p\System32\Macromed\Flash\NPSWF64*.dll #$q%~dp0NPSWF64.dll*#$q",Append
TXTAddLine,%vw%,"xcopy /y #$pWinDir#$p\SysWOW64\Macromed\Flash\NPSWF32*.dll #$q%~dp0NPSWF32.dll*#$q",Append
TXTAddLine,%vw%,"xcopy /y #$pWinDir#$p\System32\Macromed\Flash\NPSWF32*.dll #$q%~dp0NPSWF32.dll*#$q",Append
TXTAddLine,%vw%,"del /q /f Y|del %SetupFile%",Append
TXTAddLine,%vw%,"del %0",Append

[Update_Container]
If,Not,ExistFile,%ScriptDir%\FlashPlayer86_XPE_File.script,EchoExtended,"Flash Player x86 File required to update flash",,,Message,4,Exit
If,Not,ExistFile,%ScriptDir%\FlashPlayer64_XPE_File.script,EchoExtended,"Flash Player x64 File required to update flash",,,Message,4,Exit
If,Not,Existfile,%ProvideFiles%\NPSWF32.dll,EchoExtended,"NPSWF32.dll not found in Download Installer Folder#$xDownload Latest Flash Player Installer (button) and run %ProgramEXE% first.",,,Message,4,Exit
If,Not,Existfile,%ProvideFiles%\NPSWF64.dll,EchoExtended,"NPSWF64.dll not found in Download Installer Folder#$xDownload Latest Flash Player Installer (button) and run %ProgramEXE% first.",,,Message,4,Exit
Retrieve,FileVersion,%ProvideFiles%\NPSWF32.dll,%NPSWF32Ver%
Retrieve,FileVersion,%ProvideFiles%\NPSWF64.dll,%NPSWF64Ver%
//-
Retrieve,FILESIZE,%ProvideFiles%\NPSWF32.dll,%NPSWF32Size%
StrFormat,DIV,%NPSWF32Size%,1048576
ShellExecute,Hide,%GTools%\7z.exe,"a -y -m0=lzma2 -mx=9 -aoa -t7z #$q%ProvideFiles%\NPSWF32.7z#$q #$q%ProvideFiles%\NPSWF32.dll#$q"
Encode,%ScriptDir%\FlashPlayer86_XPE_File.script,Folder,%ProvideFiles%\NPSWF32.7z
IniWrite,%ScriptDir%\FlashPlayer86_XPE_File.script,Variables,#$pflashversion#$p,%NPSWF32Ver%
IniWrite,%ScriptDir%\FlashPlayer86_XPE_File.script,Main,Description,"Adobe x86 Shockwave Flash Player NPAPI - v%NPSWF32Ver% - %NPSWF32Size%MB"
//-
Retrieve,FILESIZE,%ProvideFiles%\NPSWF64.dll,%NPSWF64Size%
StrFormat,DIV,%NPSWF64Size%,1048576
ShellExecute,Hide,%GTools%\7z.exe,"a -y -m0=lzma2 -mx=9 -aoa -t7z #$q%ProvideFiles%\NPSWF64.7z#$q #$q%ProvideFiles%\NPSWF64.dll#$q"
Encode,%ScriptDir%\FlashPlayer64_XPE_File.script,Folder,%ProvideFiles%\NPSWF64.7z
IniWrite,%ScriptDir%\FlashPlayer64_XPE_File.script,Variables,#$pflashversion#$p,%NPSWF64Ver%
IniWrite,%ScriptDir%\FlashPlayer64_XPE_File.script,Main,Description,"Adobe x64 Shockwave Flash Player NPAPI - v%NPSWF64Ver% - %NPSWF64Size%MB"
//
IniWrite,%ScriptFile%,Interface,ContainerVer,"%NPSWF32Ver%,1,1,190,105,74,18,8,Bold"
IniWrite,%ScriptFile%,Main,Description,"Plugin Adds Adobe Shockwave Flash Player NPAPI Version %NPSWF32Ver%"
System,REFRESHINTERFACE
DirDeleteQ,%ProvideFiles%

[AuthorEncoded]
flash4848.ico=2749,3666
Logo=flash4848.ico

[EncodedFile-AuthorEncoded-flash4848.ico]
lines=0
0=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

[EncodedFolders]
Folder

[Folder]

[Settings_Default]
IniWrite,%ScriptFile%,Main,Level,5
IniWrite,%ScriptFile%,Main,Selected,False
IniWrite,%ScriptFile%,InterFace,InstallerVer,",1,1,190,80,74,18,8,Bold"
IniWrite,%ScriptFile%,Interface,ContainerVer,",1,1,190,105,74,18,8,Bold"
System,REFRESHINTERFACE

