[Main]
Title=Prime95
Type=XPEPlugin
Description=Prime95 has been a popular choice for stress / torture testing a CPU since its introduction, especially with overclockers and system builders.
Author=KYHI
Date=2019.10.27
Credits=TheOven.org Forum
Contact=
Version=001
Level=5
Download_Level=2
Selected=False
Mandatory=False
NoWarning=False
History001=KYHI Initial XPE Packed Plugin Created 2019.10.27
History002=

[Interface]
Shortcut_Bevel=Shortcut_Bevel,1,12,4,6,133,121
Desktop_CheckBox="Desktop Shortcut",1,3,10,10,122,18,False,"__Add Desktop Shortcut"
StartMenu_CheckBox="Start Menu Shortcut",1,3,10,28,122,18,True,"__Add Start Menu Shortcut"
TaskBpin_CheckBox="Pin To TaskBar",1,3,10,46,122,18,False,"__Add Pin To Taskbar Shortcut"
StartMpin_CheckBox="Pin To StartMenu",1,3,10,64,122,18,False,"__Add Pin To StartMenu Shortcut"
StartMenuFolder_TextBox="Start Menu Folder:",1,0,10,100,121,18,,"__Start Menu Folder Name"
RunFromWhere_ScrollBox="Run From USB",1,4,145,6,104,21,"Run From USB","Run From RAM"
Image_Software=Prime954848.ico,1,5,145,35,48,48
Button_Launch_Program=Launch,1,8,10,142,119,25,Launch_Program,Launch.bmp,False,"__Click Here To Launch Program"
HomePage_WebLabel="Home Page",1,10,338,6,55,18,https://www.mersenne.org/
Update_Container_Button=U,1,8,540,4,14,14,Update_Container,0,False,"__Update-Encode Container File"
ProgramVer_TextBox="Program Version:",1,0,450,20,82,21,298b6,"__Program File Version To Download"

[Variables]
%ProgramTitle%=Prime95
%ProgramExe%=Prime95.exe
%ProgramFolder%=Prime95
%ProgramFolderx64%=Prime95_x64
%SetupFile%=Prime95.32Bit.zip
%SetupFilex64%=Prime95.64Bit.zip
%ProvideFiles%=%ProgCache%\%ProgramFolder%
%FileContainer%=%ScriptDir%\MersennePrime95_XPE_File.Script

[Process]
Echo,"Processing %ScriptTitle%..."
If,Not,ExistFile,%FileContainer%,Exit,"%FileContainer% Container File Not Found"
//If,%Architecture%%WoW64Support%,Equal,x64False,EchoExtended,"You Need To Enable WoW64 Basic To Run %ProgramTitle% In A 64-Bit Build",,,Message,2,Exit
If,%RunFromWhere_ScrollBox%,Equal,"Run From RAM",RunFromRAM
If,%Architecture%,Equal,x64,Run,%ScriptFile%,PluginSetx64
//--
Run,%ScriptFile%,Extract
//--
If,ExistDir,%Target_Prog%\%ProgramFolder%,DirDeleteQ,%Target_Prog%\%ProgramFolder%
If,Not,ExistDir,%Target_Prog%,DirMake,%Target_Prog%
DirCopy,%GTemp%\%ProgramFolder%\%ProgramFolder%,%Target_Prog%
//--
Run,%ScriptFile%,Add_Shortcuts
//--
ExtractSectionFiles,%ScriptFile%,AddFiles
//--
Run,%ScriptFile%,Add_Registry

[AddFiles]
\Windows\System32\xxx.dll
\Windows\System32\??-??\xxx.dll.mui

[Add_Registry]
Echo,"Writing %ScriptTitle% Registry Settings..."

[Add_Shortcuts]
If,%Desktop_CheckBox%,Equal,True,AddShortcut,Desktop
If,%StartMenu_CheckBox%,Equal,True,AddShortcut,StartMenu,%StartMenuFolder_TextBox%
If,%StartMpin_CheckBox%,Equal,True,AddPin,StartMenu
If,%TaskBpin_CheckBox%,Equal,True,AddPin,TaskBar

[Extract]
Set,%SetupContainerSize%,""
IniRead,%FileContainer%,Folder,%SetupFile%,%SetupContainerSize%
If,%SetupContainerSize%-,Equal,-,Run,%ScriptFile%,Update_Container
//--
Echo,"Extracting %ScriptTitle% Setup File..."
If,ExistDir,%GTemp%\%ProgramFolder%,DirDeleteQ,%GTemp%\%ProgramFolder%
DirMake,%GTemp%\%ProgramFolder%
ExtractFile,%FileContainer%,Folder,%SetupFile%,%GTemp%\%ProgramFolder%
ShellExecute,Hide,%GTools%\7z.exe,"x #$q%GTemp%\%ProgramFolder%\%SetupFile%#$q -y -o#$q%GTemp%\%ProgramFolder%\%ProgramFolder%#$q"

[PluginSetx64]
Set,%ProgramFolder%,%ProgramFolderx64%
Set,%SetupFile%,%SetupFilex64%

[Launch_Program]
If,%HostOSArch%,Equal,x64,Run,%ScriptFile%,PluginSetx64
Run,%ScriptFile%,Extract
OpenDir,%GTemp%\%ProgramFolder%\%ProgramFolder%
//Start,,%ProgramExe%,,%GTemp%\%ProgramFolder%\%ProgramFolder%

[Update_Container]
Echo,"The Container Files Is Being Updated... Please Wait.."
If,ExistDir,%ProvideFiles%,DirDeleteQ,%ProvideFiles%
If,Not,ExistDir,%ProvideFiles%,DirMake,%ProvideFiles%
Set,%SetupURL%,http://www.mersenne.org/ftp_root/gimps/p95v%ProgramVer_TextBox%.win32.zip
Set,%SetupURLx64%,http://www.mersenne.org/ftp_root/gimps/p95v%ProgramVer_TextBox%.win64.zip
Set,%DLSetupFile%,Prime95.32Bit.zip
Set,%DLSetupFilex64%,Prime95.64Bit.zip
Download,%ProvideFiles%\%DLSetupFile%,%SetupURL%,NoExitOnError
Download,%ProvideFiles%\%DLSetupFilex64%,%SetupURLx64%,NoExitOnError
If,Not,ExistFile,%ProvideFiles%\%DLSetupFile%,EchoExtended,"Error: %DLSetupFile% has not been downloaded.",Warn,,Message,5,Exit
If,Not,ExistFile,%ProvideFiles%\%DLSetupFilex64%,EchoExtended,"Error: %DLSetupFilex64% has not been downloaded.",Warn,,Message,5,Exit
Encode,%Filecontainer%,Folder,%ProvideFiles%\%DLSetupFile%
Encode,%Filecontainer%,Folder,%ProvideFiles%\%DLSetupFilex64%
DirDeleteQ,%ProvideFiles%

[AuthorEncoded]
Prime954848.ico=1086,1448
Logo=Prime954848.ico

[EncodedFile-AuthorEncoded-Prime954848.ico]
lines=0
0=eJztmAmMTVcYx/9Di6GM1BhL6NimlmKGoA2CEsTSqC4qaIitWpFIpCK0jTaikUiE2iqaIrZWhGqsNVKhiNZoacXYKrWLrfalyb/3368v975lJjfx5r033PvP997NOefe87v3fOd837lAmqO8PDi/9bA6B8gC0MQxpwjDYOU6puYg+mCgQIECBXqaVf0C2G0r2H2zP2uzDyx3N3791zntr18xijVSvTeAl6qBVzP82aYeYM2z8eMfudBfv2IUa6ReXws+eAYk/Nmu9mDtM/HjHzvHX79iFGukOuwEt3YDz2e5bf9oDOZ3jm2zx4LVLsWPv9/a8Pvv7ABeqWocj9LAX5tbuRjFGqln74GZF8Fv3nT5x82ysliWcRVMexQ//gq3w+/fsNB4xXG7AjhomVsn1qKk+bFgFHjfGacfXgXHzLV7J1oZ18At3f/nTwf7xPD5ovTKbnBbV/BCdXBfG7DHJrDGudLDr3WxljM3V70N3i0Hnq0JDl5aevhD0nq7cCR4p7yNx3vzwIo3i79Gzz1xOjhzvD/7aCqYfbJk+KV2e2weXMwE97e2Z4oVP0LKLQCP5vhfh8/UBtvvKjn+8nfAun+CywfaOJyuA777denhD0nv/csR4M2KtgaPng9Wvh7dTmOjWPrh5/7s/S+cOPjX4/NXcdq3dN5d7gGw/nGn5J/oNl3ynfidWTLx93H5te4fbuqMfSObs/Kb0sTvzX8KG4LTJ4J5v7j1fdeDSweDt9JLhl/rxKdTXJsxATxe3z9/121gQUvwWhV3bk3+DGx2yGz1W275uRr2LPL1rPNum0hrcMx/jl1c/uaH/7kbYNPD4Hd9PGtDLfBQM7NQLiWbNgmsdwIs+wCcMMNtE2nrXrNnSAR/SP3XgCsHOL5UNvo+p16wmKOxDqnnRnDxMHfclL/OHWM+8MEcy7cS4T9eddoBHmxhc9lrS4aAVa9Et2/r7MVOZVtfBblgzlH/fRXnD3ov6lcsnfP9X6t1vcVBW0u9ppxWPpMI/jIPzffUr1hixZp4KRa/9hjeOKWYVlzekUx5+X9v4sSJ7ebDJ7PNtG/Vf6/vY/tfsuXlV3yQvyqvbLvXTPsh5eFak5QvpJq8/MpTvxpq8TwknatMddu7gMMXJX4/5Je/qPnbqNDq/luHs+2aVFHAnzr8mqMv/wSm33Lrda74qjrN759bheeGyZaX/+9K4J524ft9natMdSvesedTfE0FiUW59uXnjV//yp8+/gQctcBsfV/wemXw2zfsO1sqSbmo9/vqjx0t7k+aFl4un3npt2TTRuvFI+Hft/XtS/6uXMlbrnwiVXwmUKBAgQI9AQqOpB7/AnvC7Lp4nOMPKMrMTbU0NbEwsdDLTM5nGAUjCuxThdDvmbHL+wZN52FgAgBL+QfV9OzhVgEAAAACAAAAKwAAAO8DAAAAAAAAAQAAAAAAAAAAAAAA

[InterfaceEncoded]
Prime954848.ico=1086,1448
Launch.bmp=913,1218

[EncodedFile-InterfaceEncoded-Prime954848.ico]
lines=0
0=eJztmAmMTVcYx/9Di6GM1BhL6NimlmKGoA2CEsTSqC4qaIitWpFIpCK0jTaikUiE2iqaIrZWhGqsNVKhiNZoacXYKrWLrfalyb/3368v975lJjfx5r033PvP997NOefe87v3fOd837lAmqO8PDi/9bA6B8gC0MQxpwjDYOU6puYg+mCgQIECBXqaVf0C2G0r2H2zP2uzDyx3N3791zntr18xijVSvTeAl6qBVzP82aYeYM2z8eMfudBfv2IUa6ReXws+eAYk/Nmu9mDtM/HjHzvHX79iFGukOuwEt3YDz2e5bf9oDOZ3jm2zx4LVLsWPv9/a8Pvv7ABeqWocj9LAX5tbuRjFGqln74GZF8Fv3nT5x82ysliWcRVMexQ//gq3w+/fsNB4xXG7AjhomVsn1qKk+bFgFHjfGacfXgXHzLV7J1oZ18At3f/nTwf7xPD5ovTKbnBbV/BCdXBfG7DHJrDGudLDr3WxljM3V70N3i0Hnq0JDl5aevhD0nq7cCR4p7yNx3vzwIo3i79Gzz1xOjhzvD/7aCqYfbJk+KV2e2weXMwE97e2Z4oVP0LKLQCP5vhfh8/UBtvvKjn+8nfAun+CywfaOJyuA777denhD0nv/csR4M2KtgaPng9Wvh7dTmOjWPrh5/7s/S+cOPjX4/NXcdq3dN5d7gGw/nGn5J/oNl3ynfidWTLx93H5te4fbuqMfSObs/Kb0sTvzX8KG4LTJ4J5v7j1fdeDSweDt9JLhl/rxKdTXJsxATxe3z9/121gQUvwWhV3bk3+DGx2yGz1W275uRr2LPL1rPNum0hrcMx/jl1c/uaH/7kbYNPD4Hd9PGtDLfBQM7NQLiWbNgmsdwIs+wCcMMNtE2nrXrNnSAR/SP3XgCsHOL5UNvo+p16wmKOxDqnnRnDxMHfclL/OHWM+8MEcy7cS4T9eddoBHmxhc9lrS4aAVa9Et2/r7MVOZVtfBblgzlH/fRXnD3ov6lcsnfP9X6t1vcVBW0u9ppxWPpMI/jIPzffUr1hixZp4KRa/9hjeOKWYVlzekUx5+X9v4sSJ7ebDJ7PNtG/Vf6/vY/tfsuXlV3yQvyqvbLvXTPsh5eFak5QvpJq8/MpTvxpq8TwknatMddu7gMMXJX4/5Je/qPnbqNDq/luHs+2aVFHAnzr8mqMv/wSm33Lrda74qjrN759bheeGyZaX/+9K4J524ft9natMdSvesedTfE0FiUW59uXnjV//yp8+/gQctcBsfV/wemXw2zfsO1sqSbmo9/vqjx0t7k+aFl4un3npt2TTRuvFI+Hft/XtS/6uXMlbrnwiVXwmUKBAgQI9AQqOpB7/AnvC7Lp4nOMPKMrMTbU0NbEwsdDLTM5nGAUjCuxThdDvmbHL+wZN52FgAgBL+QfV9OzhVgEAAAACAAAAKwAAAO8DAAAAAAAAAQAAAAAAAAAAAAAA

[EncodedFile-InterfaceEncoded-Launch.bmp]
lines=0
0=eJxN0WtMFFcUAGCM/W/SXzSxaZOmTX8YtdLSJk1jQsIPpUZNSGMTWk1tKvFVMDVGCaIWRKWGgrLaRbq4AruwT92XWoshUVAhKtFAYVmWZXdgdmdnZ+beedy587gdXJr05JyTm3O/5J7kVuywrS15E+VWfWzVOqvetmpNSemb+b7V+/8HI5vLgggx+K73x2/sP1Tb9+QBRXEwrxAG4qyk0lClgcxAhRBi+RN/L1T9efTM+OUQgZ38qyvceHW0YWNrVe2z7M/j7OGXuYNP0keD443PmcHnScvvdbbXPTz4gtBVd2sqQ19vi+yqffHb7uBPW7tPHM+QujjfEOdqwzORR8PR0IDlNzeXX50fmCTshp7yj65vXt/xbmVg//6RptIDa05myeEptmGG/d73OjI3N70wY/myXze1TfXO6sInPV+WXn7vw65Pz0LSkHy67tuSJo7Uz3Dn4uze4GSMQs8oYPmd16p33N3zWX/F5wNbKz3bym5u6dZIa+r+O4fWnufI8Vm+dY7bd2fyr2X5ZZqx/BGvw5/wD9H3jzz6pe5xfWcieo/I2/u/qLhxqjlLTs0LzQnu2IPpO6zqja/4jleZGm99cMo3QWanyNI0EWsCu8u6djUmwOkkbEyClhRoHk20zxUuTaQs75wHLlY8FLF91bLlgwNvbTr9flVf04UMOk+pZ5LCSqbAxTgT/mcJIGz53oVCRCFejUTISt4mpEckXTncRsELadCyCFsWhba0NEbxxf9yLhRCkuli8S3esBc0O610MehqDlm9dRFepJQ2ClxKwdF0oehdiyAsmR6o9YtGH685AHEUkJ3F13JKO610LMPfl8ROGo1luKJ3Z8CwSvyi7gG6W8C3CoqTQw5e6ykgW06x5dCVnGzLCKOZ1X2GKPAAkaho+CTNJ+o+qLtFw5lXbuZRd16+zqAbednBoKdLQtEPUmAYkduyFlRwUMbWYh5Bc0tmn/WWbHQzkp03/qClCRoWvUdQR1RzBJv3kBlTjZhihJDmFbWAZAwJ2MXjQQH7eXWCWfVuWgwDHBNxTDKioh6GWgjggIADvOrnsItTvSyyZ+Wx7KoHmlFM0TBF3YS6aZ3hf0Pe6lhnNUPWjKL/F4rXcD14nOPySSzNS87QS8otYBgFIw9MY4bQ7szY5SXNdJ4zMAEARyYGGuVhjnsBAAAAAgAAACYAAABHAwAAAAAAAAEAAAAAAAAAAAAAAA

[EncodedFolders]
Folder

[Folder]

