[Main]
Title=Runtime Data Recovery Software
Type=XPEPlugin
Description=DiskExplorer, NAS Data Recovery, RAID Recovery for Windows, RAID Reconstructor, Captain Nemo, DriveImage XML and More
Author=KYHI
Date=2020.02.10
Credits=http://www.runtime.org
Contact=
Version=003
Level=5
Download_Level=2
Selected=False
Mandatory=False
NoWarning=False
History001=KYHI Initial XPE Plugin Created 2018.05.24
History003=KYHI - Update Check - 2020.02.10

[Interface]
Shortcut_Bevel=Shortcut_Bevel,1,12,4,6,133,97
Desktop_CheckBox="Desktop Shortcut",1,3,11,10,122,18,False,"__Add Desktop Shortcut"
StartMenu_CheckBox="Start Menu Shortcut",1,3,11,30,122,18,True,"__Add Start Menu Shortcut"
StartMenuFolder_TextBox="Start Menu Folder:",1,0,11,70,119,21,,"__Start Menu Folder Name"
RunFromWhere_ScrollBox="Run From USB",1,4,145,6,104,21,"Run From USB","Run From RAM"
Image_Software=gdbsim4848.ico,1,5,173,43,48,48
HomePage_WebLabel="Home Page",1,10,338,6,55,18,http://www.runtime.org,"__Visit Runtime Software"
pTextLabel1="Include Programs:",1,1,11,127,123,18,8,Normal
pCheckList1=SelectedProducts,1,9,11,146,171,136,

[Variables]
%ProgramTitle%=
%ProgramEXE%=
%ProgramFolder%=
%SetupFile%=
%SetupFilex86%=
%FileContainer%=%ScriptDir%\Runtime_Software_XPE_File.Script

[Process]
If,Not,ExistFile,%FileContainer%,Exit,"%FileContainer% Not Found"
If,%Architecture%%WoW64Support%,Equal,x64False,EchoExtended,"You Need To Enable WoW64 Basic To Run %ProgramTitle% In A 64-Bit Build",,,Message,2,Exit
Echo,"Processing %ScriptTitle%..."
If,%RunFromWhere_ScrollBox%,Equal,"Run From RAM",RunFromRAM
Loop,%ScriptFile%,ProcessProductNo,1,999

[ProcessProductNo]
IniRead,%ScriptFile%,AvailableProducts,product#c,%thisproduct%
if,-%thisproduct%,Equal,-,Loop,BREAK
else,begin
IniRead,%ScriptFile%,SelectedProducts,%thisproduct%,%selected%
if,-%selected%,Equal,-1,begin
IniRead,%ScriptFile%,%thisproduct%,ProgramFolder,%ProgramFolder%
if,Not,-%ProgramFolder%,Equal,-,begin
echo,"Adding product %thisproduct%..."
IniRead,%ScriptFile%,%thisproduct%,ProgramTitle,%ProgramTitle%
IniRead,%ScriptFile%,%thisproduct%,ProgramEXE,%ProgramEXE%
IniRead,%ScriptFile%,%thisproduct%,SetupFilex86,%SetupFile%
//set,%SetupFile%,%SetupFilex86%
if,Not,ExistSection,%FileContainer%,EncodedFile-Folder-%SetupFile%,Echo,"%SetupFile% NOT FOUND at %FileContainer%",Warn
if,ExistSection,%FileContainer%,EncodedFile-Folder-%SetupFile%,begin
Run,%ScriptFile%,Extract
If,Not,ExistDir,%Target_Prog%,DirMake,%Target_Prog%
If,ExistDir,%Target_Prog%\%ProgramFolder%,Shellexecute,Hide,cmd.exe,"/C rd /s /q #$q%Target_Prog%\%ProgramFolder%#$q"
If,ExistDir,%Target_Prog%\%ProgramFolder%,DirDelete,%Target_Prog%\%ProgramFolder%
DirCopy,%GTemp%\%ProgramFolder%\%ProgramFolder%,%Target_Prog%
//-
IniRead,%ScriptFile%,%thisproduct%,RegistryKey,%RegistryKey%
If,Not,%RegistryKey%-,Equal,-,Begin
Set,%registrysub%,""
If,Not,%Architecture%,Equal,x86,Set,%registrysub%,Wow6432Node\
echo,"Writing registry entries to ...\%registrysub%Runtime Software\%RegistryKey%"
RegHiveLoad,Tmp_Software,%RegSoftware%
RegWrite,HKLM,0x1,"Tmp_Software\%registrysub%Runtime Software\%RegistryKey%",InstallDir,"%PE_Programs%\%ProgramFolder%"
IniRead,%ScriptFile%,%thisproduct%,Version,%thisVersion%
RegWrite,HKLM,0x1,"Tmp_Software\%registrysub%Runtime Software\%RegistryKey%",Version,%thisVersion%
RegWrite,HKLM,0x1,"Tmp_Software\%registrysub%Runtime Software\%RegistryKey%",InstalledBy,WinPE
IniRead,%ScriptFile%,%thisproduct%,LicenseName,%thisLicenseName%
IniRead,%ScriptFile%,%thisproduct%,LicenseKey,%thisLicenseKey%
If,Not,%thisLicenseName%%thisLicenseKey%-,Equal,-,Begin
RegWrite,HKLM,0x1,"Tmp_Software\%registrysub%Runtime Software\%RegistryKey%\License",Name,"%thisLicenseName%"
RegWrite,HKLM,0x1,"Tmp_Software\%registrysub%Runtime Software\%RegistryKey%\License",Key,"%thisLicenseKey%"
end
RegHiveUnLoad,Tmp_Software
end
If,%Desktop_CheckBox%,Equal,True,AddShortcut,Desktop
If,%StartMenu_CheckBox%,Equal,True,AddShortcut,StartMenu,%StartMenuFolder_TextBox%
end
else,echo,"Missing %SetupFile%"
end
end
end
//--
If,%Architecture%,Equal,x86,ExtractSectionFiles,%ScriptFile%,AddFiles
If,%Architecture%,Equal,x64,ExtractSectionFiles,%ScriptFile%,AddFiles6432

[AvailableProducts]
product1=GetDataBack for NTFS
product2=GetDataBack for FAT
product3=DiskExplorer for NTFS
product4=DiskExplorer for FAT
product5=DiskExplorer for Linux
product6=NAS Data Recovery
product7=RAID Recovery for Windows
product8=RAID Reconstructor
product9=Captain Nemo
product10=DriveImage XML

[SelectedProducts]
GetDataBack for NTFS=1
GetDataBack for FAT=1
DiskExplorer for NTFS=1
DiskExplorer for FAT=1
DiskExplorer for Linux=1
NAS Data Recovery=1
RAID Recovery for Windows=1
RAID Reconstructor=1
Captain Nemo=1
DriveImage XML=1

[GetDataBack for NTFS]
ProgramFolder=GetDataBack for NTFS
ProgramTitle=GetDataBack for NTFS
ProgramEXE=gdbnt.exe
SetupFilex86=getdataback_for_ntfs.7z
RegistryKey=GetDataBackNT
Version=4.33.000
LicenseName=User 2k10
LicenseKey=H2VJVTA2W3Y6EW9QZ4T3QFVDB9H

[GetDataBack for FAT]
ProgramFolder=GetDataBack for FAT
ProgramTitle=GetDataBack for FAT
ProgramEXE=gdb.exe
SetupFilex86=getdataback_for_fat.7z
RegistryKey=GetDataBack
Version=4.33.000
LicenseName=User 2k10
LicenseKey=G1XXM9QJW0YKV9NHGLBVKSJSUN0

[DiskExplorer for NTFS]
ProgramFolder=DiskExplorer for NTFS
ProgramTitle=DiskExplorer for NTFS
ProgramEXE=ntexplorer.exe
SetupFilex86=diskexplorer_for_ntfs.7z
RegistryKey=NTExplorer
Version=4.32.000
LicenseName=Hans Norer
LicenseKey=GGAUWLQQYWEDAU

[DiskExplorer for FAT]
ProgramFolder=DiskExplorer for FAT
ProgramTitle=DiskExplorer for FAT
ProgramEXE=diskexpl.exe
SetupFilex86=diskexplorer_for_fat.7z
RegistryKey=DiskExplorer
Version=4.32.000
LicenseName=Hans Norer
LicenseKey=DJZJIJWFLSZIJW

[DiskExplorer for Linux]
ProgramFolder=DiskExplorer for Linux
ProgramTitle=DiskExplorer for Linux
ProgramEXE=linuxexplorer.exe
SetupFilex86=diskexplorer_for_linux.7z
RegistryKey=LinuxExplorer
Version=4.36.000
LicenseName=Hans Norer
LicenseKey=EATIGFTMWGQQAA

[RAID Recovery for Windows]
ProgramFolder=RAID Recovery for Windows
ProgramTitle=RAID Recovery for Windows
ProgramEXE=winraid.exe
SetupFilex86=raid_recovery_for_windows.7z
RegistryKey=RAID Recovery for Windows
Version=2.41.000
LicenseName=Hans Norer
LicenseKey=CMZCOMQJZPPZNQ

[NAS Data Recovery]
ProgramFolder=NAS Data Recovery
ProgramTitle=NAS Data Recovery
ProgramEXE=nas.exe
SetupFilex86=NAS_Data_Recovery.7z
RegistryKey=NAS Data Recovery
Version=2.42.000
LicenseName=Hans Norer
LicenseKey=DALHKBKOLISVOS

[RAID Reconstructor]
ProgramFolder=RAID Reconstructor
ProgramTitle=RAID Reconstructor
ProgramEXE=raid.exe
SetupFilex86=RAID_Reconstructor.7z
RegistryKey=RAID
Version=4.40.000
LicenseName=Joseph Scalzo
LicenseKey=CXCYMPGTFYPMKH

[Captain Nemo]
ProgramFolder=Captain Nemo
ProgramTitle=Captain Nemo
ProgramEXE=nemo.exe
SetupFilex86=captain_nemo.7z
RegistryKey=Captain Nemo
Version=5.41.000
LicenseName=Phyllis Clark
LicenseKey=FEJCLGEHOTLORG

[DriveImage XML]
ProgramFolder=DriveImage XML
ProgramTitle=DriveImage XML
ProgramEXE=dixml.exe
SetupFilex86=driveimage_xml.7z
RegistryKey=DIXML
Version=2.50.000
LicenseName=
LicenseKey=

[AddFiles]
\Windows\System32\APPHELP.DLL
\Windows\System32\DWrite.dll
\Windows\System32\GdiPlus.dll
\Windows\System32\lz32.dll
\Windows\System32\msimg32.dll
\Windows\System32\oleacc.dll
\Windows\System32\oleaccrc.dll
\Windows\System32\riched20.dll
\Windows\System32\riched32.dll
\Windows\System32\sfc.dll
\Windows\System32\sfc_os.dll
\Windows\System32\urlmon.dll
\Windows\System32\wininet.dll
\Windows\System32\winsta.dll
\Windows\System32\wow32.dll
\Windows\System32\wtsapi32.dll
\Windows\System32\??-??\APPHELP.dll.mui
\Windows\System32\??-??\DWrite.dll.mui
\Windows\System32\??-??\oleaccrc.dll.mui

[AddFiles6432]
\Windows\SysWOW64\APPHELP.DLL
\Windows\SysWOW64\DWrite.dll
\Windows\SysWOW64\GdiPlus.dll
\Windows\SysWOW64\lz32.dll
\Windows\SysWOW64\msimg32.dll
\Windows\SysWOW64\oleacc.dll
\Windows\SysWOW64\oleaccrc.dll
\Windows\SysWOW64\riched20.dll
\Windows\SysWOW64\riched32.dll
\Windows\SysWOW64\sfc.dll
\Windows\SysWOW64\sfc_os.dll
\Windows\SysWOW64\urlmon.dll
\Windows\SysWOW64\wininet.dll
\Windows\SysWOW64\winsta.dll
\Windows\SysWOW64\wow32.dll
\Windows\SysWOW64\wtsapi32.dll
\Windows\SysWOW64\??-??\APPHELP.dll.mui
\Windows\SysWOW64\??-??\DWrite.dll.mui
\Windows\SysWOW64\??-??\oleaccrc.dll.mui
\Windows\SysWOW64\??-??\urlmon.dll.mui

[Extract]
echo,"Preparing Extraction Of Files From %SetupFile%"
If,ExistDir,%GTemp%\%ProgramFolder%,Shellexecute,Hide,cmd.exe,"/C rd /s /q #$q%GTemp%\%ProgramFolder%#$q"
If,ExistDir,%GTemp%\%ProgramFolder%,DirDelete,%GTemp%\%ProgramFolder%
DirMake,%GTemp%\%ProgramFolder%
echo,"Extracting Files From %SetupFile% To %GTemp%\...\%ProgramFolder%"
ExtractFile,%FileContainer%,Folder,%SetupFile%,%GTemp%\%ProgramFolder%
ShellExecute,Hide,%Tools%\7z.exe,"x #$q%GTemp%\%ProgramFolder%\%SetupFile%#$q -y -o#$q%GTemp%\%ProgramFolder%\%ProgramFolder%#$q"

[AuthorEncoded]
Logo=gdbsim4848.ico
gdbsim4848.ico=1364,1819

[EncodedFile-AuthorEncoded-gdbsim4848.ico]
lines=0
0=eJztWF1II1cYvfljZfugq1BEKG4XpMEn0RffspSFFoRiQeiCIMI+uLAg+xYfKgZK8DEPRQp9CSyELQslIEIpFBwbu1urJTRV22JlFAW3aJulKzRZf07vSXKXMUzG+QlOH/rJ58E4M/d8957v3JsRIiB/+vqE/H1TfNEjxJtCiKhM+ZEYF9XPGYke8X+4jAngsyFgfgF4328uTkMHOsPAqyBwKgB0AXtzwP0i0OY3NzuRAh4q7ipZz3XgmOtSAKJ+c7SKDuDQyL2+DuK7wDcZ4K7fXOsjCww34m7MCFCuaWs/CUxRc35zZ9wBvg4AZ3ZqMCY15zf3PNDnlDeTfSHnv8Vv/pNyGkPAiRPu7Afe52XcQuHvKNPLMzh/qjedprz3ppexh4YK80JoGBhYW81kDlx5gplnXpZcK+5xXrjr+nEnuTMDAe2M2NGxfJhM6lPV/9mLt4FtN3PvdX+enNxKhcPaK1WDSvXZ2NhmOpc7GrR6hvJMp/p5B/jFC3dd11va2pb/quduVge1lU4fjPMes2dxHitaMHi7VVJrXj1zbm7/fjConVrxV6mua29fPrLqEfZiHJh9A3hp1Q/N8Mze3h/W7XCvz2z2+fBlzya3NDB+C9iqX5NmeObiYvG2G+5dXc/2nY6VAwY/Ah4be6QZnmnWt1ZJf0qldl1rlmccaotnUC/cjZ7pJFlvsVj0/QzfyDOtMhJZKk9M/OZp3poR9D96iJv5z+eLfX7z5zknGl3ZIJ9QaOnErnfS//3mbgzuqSMjG0/s1mHHM52ErqPlrafYjW9jVv/HvRexl+Px7dkbN3J/NuJOvTXad91GahcPAxrOwpr0Uw0Y2cCTxSJuu30e+fF8oPY0tSbs2+lpPdE85tXoWcGv5K1S1XHre/yePsA418fts43aikS0spNzqJ1Y+EOeOQ3czfL6tzhuhrbcfh+wiqEC5qmdy2oILcnvchI/XMeXXrTVzKjM5yW865O1RpZQ1o/9f0cxuYWU0rrd5PVjm0j7zZ09SV07nX9mvghPe+fCgvf3sPTMoCa/Ezjgzev7f8Sal3HzedYOeXbGXjKJqWLR3XvY6Ao23Mx99jk87Z2jo3gUDkvNyhqIkQjKY2NIFwr238Pa8UyzbF/GkZe9QN7bqbgbkzUQBwawmslc/h72g5+RteOZ9X2b1DHlljuDejHjrzIYlHqW2NGBQ17Lek3nQXof9yPOp9K1Hf5ePJPr1t4ux2vAvdGaUFtWa87zwcAaVo3nBjPuo5t45JY7I5vFsJpfuxkI4GxwEN/ZeX7uCIP0dXI1q8OrZ5KHU/5M1u1kHGqEOu96ir1me6bTpN68+EXmAHff+wlfefXMe/fwuVXfmmUohBP2sJdxmxHcn5xyV3tDI/+5ykil5Hcj2YdOudN3/ObOePAAnyo9OKmh2jP/jaAOpqeRsOP/9KjeXqz7zblRpNMY7++nn5mvCfnbOUP4HdQHNU6tG+vw6plXHdQWfVKep/fJPx7HrN+c3AZ1c5WeiUpU8FkNEwpjNWytoghcwPPXGJJYlscKYmnmVFyT+KK1hqGS4P074uMaxhRq3XwbJmZKNTzneAkxU+GTEFVeQmGgiprEHJ8rkW/TTkMSu+VVn0ii1yQeSAyIi3dX/z6v4BkJSyzFaiiJEl+EJGGiJErcEd2J1grGdmpY4jiaiKGKM5V5SrxGXEASJZZqeF5DEq3gywr+CwMKTWN4nONLT0kqzsw1sTCx0MtMzmcYBSML7FOF0Gys2OUf8LWyMjABAEqMBy56XuTqAQAAAAIAAAAqAAAABgUAAAAAAAABAAAAAAAAAAAAAAA

[InterfaceEncoded]
gdbsim4848.ico=1364,1819

[EncodedFile-InterfaceEncoded-gdbsim4848.ico]
lines=0
0=eJztWF1II1cYvfljZfugq1BEKG4XpMEn0RffspSFFoRiQeiCIMI+uLAg+xYfKgZK8DEPRQp9CSyELQslIEIpFBwbu1urJTRV22JlFAW3aJulKzRZf07vSXKXMUzG+QlOH/rJ58E4M/d8957v3JsRIiB/+vqE/H1TfNEjxJtCiKhM+ZEYF9XPGYke8X+4jAngsyFgfgF4328uTkMHOsPAqyBwKgB0AXtzwP0i0OY3NzuRAh4q7ipZz3XgmOtSAKJ+c7SKDuDQyL2+DuK7wDcZ4K7fXOsjCww34m7MCFCuaWs/CUxRc35zZ9wBvg4AZ3ZqMCY15zf3PNDnlDeTfSHnv8Vv/pNyGkPAiRPu7Afe52XcQuHvKNPLMzh/qjedprz3ppexh4YK80JoGBhYW81kDlx5gplnXpZcK+5xXrjr+nEnuTMDAe2M2NGxfJhM6lPV/9mLt4FtN3PvdX+enNxKhcPaK1WDSvXZ2NhmOpc7GrR6hvJMp/p5B/jFC3dd11va2pb/quduVge1lU4fjPMes2dxHitaMHi7VVJrXj1zbm7/fjConVrxV6mua29fPrLqEfZiHJh9A3hp1Q/N8Mze3h/W7XCvz2z2+fBlzya3NDB+C9iqX5NmeObiYvG2G+5dXc/2nY6VAwY/Ah4be6QZnmnWt1ZJf0qldl1rlmccaotnUC/cjZ7pJFlvsVj0/QzfyDOtMhJZKk9M/OZp3poR9D96iJv5z+eLfX7z5zknGl3ZIJ9QaOnErnfS//3mbgzuqSMjG0/s1mHHM52ErqPlrafYjW9jVv/HvRexl+Px7dkbN3J/NuJOvTXad91GahcPAxrOwpr0Uw0Y2cCTxSJuu30e+fF8oPY0tSbs2+lpPdE85tXoWcGv5K1S1XHre/yePsA418fts43aikS0spNzqJ1Y+EOeOQ3czfL6tzhuhrbcfh+wiqEC5qmdy2oILcnvchI/XMeXXrTVzKjM5yW865O1RpZQ1o/9f0cxuYWU0rrd5PVjm0j7zZ09SV07nX9mvghPe+fCgvf3sPTMoCa/Ezjgzev7f8Sal3HzedYOeXbGXjKJqWLR3XvY6Ao23Mx99jk87Z2jo3gUDkvNyhqIkQjKY2NIFwr238Pa8UyzbF/GkZe9QN7bqbgbkzUQBwawmslc/h72g5+RteOZ9X2b1DHlljuDejHjrzIYlHqW2NGBQ17Lek3nQXof9yPOp9K1Hf5ePJPr1t4ux2vAvdGaUFtWa87zwcAaVo3nBjPuo5t45JY7I5vFsJpfuxkI4GxwEN/ZeX7uCIP0dXI1q8OrZ5KHU/5M1u1kHGqEOu96ir1me6bTpN68+EXmAHff+wlfefXMe/fwuVXfmmUohBP2sJdxmxHcn5xyV3tDI/+5ykil5Hcj2YdOudN3/ObOePAAnyo9OKmh2jP/jaAOpqeRsOP/9KjeXqz7zblRpNMY7++nn5mvCfnbOUP4HdQHNU6tG+vw6plXHdQWfVKep/fJPx7HrN+c3AZ1c5WeiUpU8FkNEwpjNWytoghcwPPXGJJYlscKYmnmVFyT+KK1hqGS4P074uMaxhRq3XwbJmZKNTzneAkxU+GTEFVeQmGgiprEHJ8rkW/TTkMSu+VVn0ii1yQeSAyIi3dX/z6v4BkJSyzFaiiJEl+EJGGiJErcEd2J1grGdmpY4jiaiKGKM5V5SrxGXEASJZZqeF5DEq3gywr+CwMKTWN4nONLT0kqzsw1sTCx0MtMzmcYBSML7FOF0Gys2OUf8LWyMjABAEqMBy56XuTqAQAAAAIAAAAqAAAABgUAAAAAAAABAAAAAAAAAAAAAAA

[EncodedFolders]
Folder

[Folder]

