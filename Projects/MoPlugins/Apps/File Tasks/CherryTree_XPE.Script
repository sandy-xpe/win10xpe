[Main]
Title=CherryTree
Type=XPEPlugin
Description=Cherrytree is a hierarchical note taking application, featuring rich text and syntax highlighting, storing data in a single xml or sqlite file. (v0.39.2.0)
Author=KYHI
Date=2020.04.13
Credits=TheOven.org Forum
Contact=
Version=001
Level=5
Download_Level=2
Selected=False
Mandatory=False
NoWarning=False
History001=KYHI Initial XPE Packed Plugin Created 2020.04.13
History002=

[Interface]
Shortcut_Bevel=Shortcut_Bevel,1,12,4,6,133,121
Desktop_CheckBox="Desktop Shortcut",1,3,10,10,122,18,False,"__Add Desktop Shortcut"
StartMenu_CheckBox="Start Menu Shortcut",1,3,10,28,122,18,True,"__Add Start Menu Shortcut"
TaskBpin_CheckBox="Pin To TaskBar",1,3,10,46,122,18,False,"__Add Pin To Taskbar Shortcut"
StartMpin_CheckBox="Pin To StartMenu",1,3,10,64,122,18,False,"__Add Pin To StartMenu Shortcut"
StartMenuFolder_TextBox="Start Menu Folder:",1,0,10,100,121,18,,"__Start Menu Folder Name"
RunFromWhere_ScrollBox="Run From USB",1,4,145,6,104,21,"Run From USB","Run From RAM"
Image_Software=cherrytree4848.ico,1,5,145,35,48,48
Button_Launch_Program=Launch,1,8,10,142,119,25,Launch_Program,Launch.bmp,False,"__Click Here To Launch Program"
HomePage_WebLabel="Home Page",1,10,338,6,55,18,https://www.giuspen.com/cherrytree/
Update_Container_Button=U,0,8,540,4,14,14,Update_Container,0,False,"__Update-Encode Container File"
CFG_Btn="Your Config.cfg Here",1,8,4,182,133,25,Provide_CFG,Launch.bmp,False

[Variables]
%ProgramTitle%=cherrytree
%ProgramExe%=bin\cherrytree.exe
%ProgramFolder%=CherryTree
%ProgramFolderT%=cherrytree_0.39.2_win32_portable
%SetupFile%=cherrytree_0.39.2_win32_portable.7z
%SetupURL%=http://www.giuspen.com/software/cherrytree_0.39.2_win32_portable.7z
%ProvideFiles%=%ProgCache%\%ProgramFolder%
%FileContainer%=%ScriptDir%\CherryTree_XPE_File.Script
%ProvideCFG%=%GCustom%\%ProgramFolder%

[Process]
Echo,"Processing %ScriptTitle%..."
If,Not,ExistFile,%FileContainer%,Exit,"%FileContainer% Container File Not Found"
If,%Architecture%%WoW64Support%,Equal,x64False,EchoExtended,"You Need To Enable WoW64 Basic To Run %ProgramTitle% In A 64-Bit Build",,,Message,2,Exit
IniRead,%ProjectDir%\Script.Project,Features,VCRuntime,%VCRuntime%
If,%VCRuntime%,Equal,False,Exec,%ProjectDir%\Features\VCRuntime.Script,Process
If,%RunFromWhere_ScrollBox%,Equal,"Run From RAM",RunFromRAM
//--
Run,%ScriptFile%,Extract
//--
If,ExistDir,%Target_Prog%\%ProgramFolder%,DirDeleteQ,%Target_Prog%\%ProgramFolder%
If,Not,ExistDir,%Target_Prog%,DirMake,%Target_Prog%
DirCopy,%GTemp%\%ProgramFolderT%\%ProgramFolder%,%Target_Prog%
//--
Run,%ScriptFile%,Add_Shortcuts
//--
ExtractSectionFiles,%ScriptFile%,AddFiles
If,%Architecture%,Equal,x64,ExtractSectionFiles,%ScriptFile%,AddFiles6432
//--
//Run,%ScriptFile%,Add_Registry
//--
//Run,%ScriptFile%,Add_Associations

[AddFiles]
\Windows\System32\icm32.dll
\Windows\System32\taskkill.exe
\Windows\System32\??-??\taskkill.exe.mui

[AddFiles6432]
\Windows\SysWOW64\icm32.dll
\Windows\SysWOW64\taskkill.exe
\SysWOW64\en-US\taskkill.exe.mui

[Add_Registry]
Echo,"Writing %ScriptTitle% Registry Settings..."
//- Add Registry Values <-- Use RegCPE

[Add_Associations]
//- Associate,Ext <-- Three Letter File Extension

[Add_Shortcuts]
If,%Desktop_CheckBox%,Equal,True,AddShortcut,Desktop
If,%StartMenu_CheckBox%,Equal,True,AddShortcut,StartMenu,%StartMenuFolder_TextBox%
If,%StartMpin_CheckBox%,Equal,True,AddPin,StartMenu
If,%TaskBpin_CheckBox%,Equal,True,AddPin,TaskBar

[Extract]
Set,%SetupContainerSize%,""
IniRead,%FileContainer%,Folder,%SetupFile%,%SetupContainerSize%
If,%SetupContainerSize%-,Equal,-,Run,%ScriptFile%,Update_Container
//--
Echo,"Extracting %ScriptTitle% Setup File..."
If,ExistDir,%GTemp%\%ProgramFolderT%,DirDeleteQ,%GTemp%\%ProgramFolderT%
DirMake,%GTemp%\%ProgramFolderT%
ExtractFile,%FileContainer%,Folder,%SetupFile%,%GTemp%\%ProgramFolderT%
ShellExecute,Hide,%GTools%\7z.exe,"x #$q%GTemp%\%ProgramFolderT%\%SetupFile%#$q -y -o#$q%GTemp%\%ProgramFolderT%#$q"
FileRename,%GTemp%\%ProgramFolderT%\%ProgramFolderT%,%GTemp%\%ProgramFolderT%\%ProgramFolder%
If,ExistFile,%ProvideCFG%\Config.cfg,FileCopy,%ProvideCFG%\Config.cfg,%GTemp%\%ProgramFolderT%\%ProgramFolder%\Bin
Else,FileCreateBlank,%GTemp%\%ProgramFolderT%\%ProgramFolder%\Bin\Config.cfg

[Launch_Program]
Run,%ScriptFile%,Extract
//OpenDir,%GTemp%\%ProgramFolderT%\%ProgramFolder%
Start,,%ProgramExe%,,%GTemp%\%ProgramFolderT%\%ProgramFolder%

[Update_Container]
Echo,"The Container Files Is Being Updated... Please Wait.."
If,ExistDir,%ProvideFiles%,DirDeleteQ,%ProvideFiles%
If,Not,ExistDir,%ProvideFiles%,DirMake,%ProvideFiles%
Download,%ProvideFiles%\%SetupFile%,%SetupURL%,NoExitOnError
If,Not,ExistFile,%ProvideFiles%\%SetupFile%,EchoExtended,"Error: %SetupFile% has not been downloaded.",Warn,,Message,5,Exit
Encode,%Filecontainer%,Folder,%ProvideFiles%\%SetupFile%
DirDeleteQ,%ProvideFiles%

[Provide_CFG]
OpenDir,%ProvideCFG%

[AuthorEncoded]
cherrytree4848.ico=2191,2922
Logo=cherrytree4848.ico

[EncodedFile-AuthorEncoded-cherrytree4848.ico]
lines=0
0=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

[InterfaceEncoded]
cherrytree4848.ico=2191,2922
Launch.bmp=913,1218

[EncodedFile-InterfaceEncoded-cherrytree4848.ico]
lines=0
0=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

[EncodedFile-InterfaceEncoded-Launch.bmp]
lines=0
0=eJxN0WtMFFcUAGCM/W/SXzSxaZOmTX8YtdLSJk1jQsIPpUZNSGMTWk1tKvFVMDVGCaIWRKWGgrLaRbq4AruwT92XWoshUVAhKtFAYVmWZXdgdmdnZ+beedy587gdXJr05JyTm3O/5J7kVuywrS15E+VWfWzVOqvetmpNSemb+b7V+/8HI5vLgggx+K73x2/sP1Tb9+QBRXEwrxAG4qyk0lClgcxAhRBi+RN/L1T9efTM+OUQgZ38qyvceHW0YWNrVe2z7M/j7OGXuYNP0keD443PmcHnScvvdbbXPTz4gtBVd2sqQ19vi+yqffHb7uBPW7tPHM+QujjfEOdqwzORR8PR0IDlNzeXX50fmCTshp7yj65vXt/xbmVg//6RptIDa05myeEptmGG/d73OjI3N70wY/myXze1TfXO6sInPV+WXn7vw65Pz0LSkHy67tuSJo7Uz3Dn4uze4GSMQs8oYPmd16p33N3zWX/F5wNbKz3bym5u6dZIa+r+O4fWnufI8Vm+dY7bd2fyr2X5ZZqx/BGvw5/wD9H3jzz6pe5xfWcieo/I2/u/qLhxqjlLTs0LzQnu2IPpO6zqja/4jleZGm99cMo3QWanyNI0EWsCu8u6djUmwOkkbEyClhRoHk20zxUuTaQs75wHLlY8FLF91bLlgwNvbTr9flVf04UMOk+pZ5LCSqbAxTgT/mcJIGz53oVCRCFejUTISt4mpEckXTncRsELadCyCFsWhba0NEbxxf9yLhRCkuli8S3esBc0O610MehqDlm9dRFepJQ2ClxKwdF0oehdiyAsmR6o9YtGH685AHEUkJ3F13JKO610LMPfl8ROGo1luKJ3Z8CwSvyi7gG6W8C3CoqTQw5e6ykgW06x5dCVnGzLCKOZ1X2GKPAAkaho+CTNJ+o+qLtFw5lXbuZRd16+zqAbednBoKdLQtEPUmAYkduyFlRwUMbWYh5Bc0tmn/WWbHQzkp03/qClCRoWvUdQR1RzBJv3kBlTjZhihJDmFbWAZAwJ2MXjQQH7eXWCWfVuWgwDHBNxTDKioh6GWgjggIADvOrnsItTvSyyZ+Wx7KoHmlFM0TBF3YS6aZ3hf0Pe6lhnNUPWjKL/F4rXcD14nOPySSzNS87QS8otYBgFIw9MY4bQ7szY5SXNdJ4zMAEARyYGGuVhjnsBAAAAAgAAACYAAABHAwAAAAAAAAEAAAAAAAAAAAAAAA

[EncodedFolders]
Folder

[Folder]
