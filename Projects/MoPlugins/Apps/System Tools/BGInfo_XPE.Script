[Main]
Title=BGInfo
Type=XPEPlugin
Description=BGInfo automatically displays relevant information about a Windows computer on the desktop's background
Author=KYHI
Date=2019.04.01
Credits=
Contact=
Version=002
Level=5
Download_Level=2
Selected=False
Mandatory=False
NoWarning=False
History001=KYHI Initial XPE Plugin Created 2018.07.25
History002=KYHI - M&M Check - 2019.04.01

[Interface]
Shortcut_Bevel=Shortcut_Bevel,1,12,4,6,133,121
Desktop_CheckBox="Desktop Shortcut",1,3,10,10,122,18,True,"__Add Desktop Shortcut"
StartMenu_CheckBox="Start Menu Shortcut",1,3,10,28,122,18,True,"__Add Start Menu Shortcut"
StartMpin_CheckBox="Pin To StartMenu",1,3,10,64,122,18,False,"__Add Pin To StartMenu Shortcut"
TaskBpin_CheckBox="Pin To TaskBar",1,3,10,46,122,18,False,"__Add Pin To Taskbar Shortcut"
StartMenuFolder_TextBox="Start Menu Folder:",1,0,10,100,121,18,,"__Start Menu Folder Name"
RunFromWhere_ScrollBox="Run From USB",1,4,145,6,104,21,"Run From USB","Run From RAM"
Image_Software=BGInfo4848.ico,1,5,146,35,100,100,
Button_Launch_Program=Launch,1,8,10,142,119,25,Launch_Program,Launch.bmp,False,_Launch_Program_,False,"__Click Here To Launch Program"
HomePage_WebLabel="Home Page",1,10,338,6,55,18,https://docs.microsoft.com/en-us/sysinternals/downloads/bginfo
Update_Container_Button=U,1,8,540,1,14,14,Update_Container,0,False,"__Update Plugin Program File"

[Variables]
%ProgramTitle%=BGInfo
%ProgramExe%=BGInfo.exe
%ProgramExex64%=BGInfo64.exe
%ProgramFolder%=BGInfo
%SetupFile%=BGInfo.zip
%ProvideFiles%=%ProgCache%\%ProgramFolder%
%SetupURL%=https://download.sysinternals.com/files/BGInfo.zip

[Process]
Echo,"Processing %ScriptTitle%..."
If,%RunFromWhere_ScrollBox%,Equal,"Run From RAM",RunFromRAM
If,%Architecture%,Equal,x64,Run,%ScriptFile%,PluginSetx64
//--
Run,%ScriptFile%,Extract
//--
If,ExistDir,%Target_Prog%\%ProgramFolder%,DirDeleteQ,%Target_Prog%\%ProgramFolder%
If,Not,ExistDir,%Target_Prog%\%ProgramFolder%,DirMake,%Target_Prog%\%ProgramFolder%
FileCopy,%GTemp%\%ProgramFolder%\%ProgramFolder%\%ProgramExe%,%Target_Prog%\%ProgramFolder%
//--
Run,%ScriptFile%,Add_Shortcuts
//--
//ExtractSectionFiles,%ScriptFile%,AddFiles
//--
Run,%ScriptFile%,Add_Registry

[AddFiles]
\Windows\System32\xxx.dll
\Windows\System32\??-??\xxx.dll.mui

[Add_Registry]
RegHiveLoad,Tmp_Default,%RegDefault%
RegWrite,HKLM,0x1,Tmp_Default\Software\Classes\BGInfo.Config.1,,"BGInfo Configuration File"
RegWrite,HKLM,0x1,Tmp_Default\Software\Classes\BGInfo.Config.1\DefaultIcon,,"#$q%PE_Programs%\%ProgramFolder%\Programexe%#$q,0"
RegWrite,HKLM,0x1,Tmp_Default\Software\Classes\BGInfo.Config.1\shell\open\command,,"#$q%PE_Programs%\%ProgramFolder%\Programexe%#$q #$q#$p1#$q"
RegWrite,HKLM,0x4,Tmp_Default\Software\Sysinternals\BGInfo,EulaAccepted,1
RegWrite,HKLM,0x1,Tmp_Default\Software\Winternals\BGInfo,Wallpaper,X:\Windows\Web\Wallpaper\Windows\img0.jpg
RegWrite,HKLM,0x4,Tmp_Default\Software\Winternals\BGInfo,WallpaperPos,3
RegWrite,HKLM,0x4,Tmp_Default\Software\Winternals\BGInfo,Background,0
RegWrite,HKLM,0x4,Tmp_Default\Software\Winternals\BGInfo,Position,1020
RegWrite,HKLM,0x4,Tmp_Default\Software\Winternals\BGInfo,Monitor,1116
RegWrite,HKLM,0x4,Tmp_Default\Software\Winternals\BGInfo,TaskbarAdjust,1
RegWrite,HKLM,0x4,Tmp_Default\Software\Winternals\BGInfo,TextWidth2,31680
RegWrite,HKLM,0x1,Tmp_Default\Software\Winternals\BGInfo,OutputFile,#$pTemp#$p\BGInfo.bmp
RegWrite,HKLM,0x1,Tmp_Default\Software\Winternals\BGInfo,Database,
RegWrite,HKLM,0x1,Tmp_Default\Software\Winternals\BGInfo,DatabaseMRU,
RegWrite,HKLM,0x4,Tmp_Default\Software\Winternals\BGInfo,WallpaperUser,1
RegWrite,HKLM,0x4,Tmp_Default\Software\Winternals\BGInfo,MaxColorBits,0
RegWrite,HKLM,0x4,Tmp_Default\Software\Winternals\BGInfo,ErrorNotify,0
RegWrite,HKLM,0x4,Tmp_Default\Software\Winternals\BGInfo,UserScreen,1
RegWrite,HKLM,0x4,Tmp_Default\Software\Winternals\BGInfo,LogonScreen,0
RegWrite,HKLM,0x4,Tmp_Default\Software\Winternals\BGInfo,TerminalScreen,0
RegWrite,HKLM,0x4,Tmp_Default\Software\Winternals\BGInfo,OpaqueTextBox,0
RegWrite,HKLM,0x3,Tmp_Default\Software\Winternals\BGInfo,WindowPosition,2c,00,00,00,00,00,00,00,01,00,00,00,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,ff,cc,01,00,00,ab,00,00,00,fb,03,00,00,83,02,00,00
RegWrite,HKLM,0x1,Tmp_Default\Software\Winternals\BGInfo\UserFields
RegHiveUnLoad,Tmp_Default
//--
RegHiveLoad,Tmp_Software,%RegSoftware%
RegWrite,HKLM,0x1,Tmp_Software\Classes\.bgi,,BGInfo.Config.1
RegWrite,HKLM,0x1,Tmp_Software\Classes\BGInfo.Config.1,,"BGInfo Configuration File"
RegWrite,HKLM,0x1,Tmp_Software\Classes\BGInfo.Config.1\DefaultIcon,,"#$q%PE_Programs%\%ProgramFolder%\Programexe%#$q,0"
RegWrite,HKLM,0x1,Tmp_Software\Classes\BGInfo.Config.1\shell\open\command,,"#$q%PE_Programs%\%ProgramFolder%\Programexe%#$q #$q#$p1#$q"
RegHiveUnLoad,Tmp_Software

[Add_Shortcuts]
If,%Desktop_CheckBox%,Equal,True,AddShortcut,Desktop
If,%StartMenu_CheckBox%,Equal,True,AddShortcut,StartMenu,%StartMenuFolder_TextBox%
If,%StartMpin_CheckBox%,Equal,True,AddPin,StartMenu
If,%TaskBpin_CheckBox%,Equal,True,AddPin,TaskBar

[Extract]
Set,%SetupContainerSize%,""
IniRead,%ScriptFile%,Folder,%SetupFile%,%SetupContainerSize%
If,%SetupContainerSize%-,Equal,-,Run,%ScriptFile%,Update_Container
//--
If,ExistDir,%GTemp%\%ProgramFolder%,DirDeleteQ,%GTemp%\%ProgramFolder%
If,Not,ExistDir,%GTemp%\%ProgramFolder%,DirMake,%GTemp%\%ProgramFolder%
ExtractAllFiles,%ScriptFile%,Folder,%GTemp%\%ProgramFolder%
ShellExecute,Hide,%GTools%\7z.exe,"x #$q%GTemp%\%ProgramFolder%\%SetupFile%#$q -y -o#$q%GTemp%\%ProgramFolder%\%ProgramFolder%#$q"

[PluginSetx64]
//Set,%ProgramFolder%,%ProgramFolder%_x64
Set,%ProgramExe%,%ProgramExex64%

[Launch_Program]
If,%HostOSArch%,Equal,x64,Run,%ScriptFile%,PluginSetx64
Run,%ScriptFile%,Extract
OpenDir,%GTemp%\%ProgramFolder%\%ProgramFolder%
//Start,,%ProgramExe%,,%GTemp%\%ProgramFolder%\%ProgramFolder%

[Update_Container]
If,ExistDir,%ProvideFiles%,DirDeleteQ,%ProvideFiles%
DirMake,%ProvideFiles%
Download,%ProvideFiles%\%SetupFile%,%SetupURL%
Encode,%ScriptFile%,Folder,%ProvideFiles%\%SetupFile%
DirDeleteQ,%ProvideFiles%

[AuthorEncoded]
Logo=BGInfo4848.ico
BGInfo4848.ico=2896,3862

[InterfaceEncoded]
Launch.bmp=913,1218

[EncodedFolders]
Folder

[EncodedFile-InterfaceEncoded-Launch.bmp]
lines=0
0=eJxN0WtMFFcUAGCM/W/SXzSxaZOmTX8YtdLSJk1jQsIPpUZNSGMTWk1tKvFVMDVGCaIWRKWGgrLaRbq4AruwT92XWoshUVAhKtFAYVmWZXdgdmdnZ+beedy587gdXJr05JyTm3O/5J7kVuywrS15E+VWfWzVOqvetmpNSemb+b7V+/8HI5vLgggx+K73x2/sP1Tb9+QBRXEwrxAG4qyk0lClgcxAhRBi+RN/L1T9efTM+OUQgZ38qyvceHW0YWNrVe2z7M/j7OGXuYNP0keD443PmcHnScvvdbbXPTz4gtBVd2sqQ19vi+yqffHb7uBPW7tPHM+QujjfEOdqwzORR8PR0IDlNzeXX50fmCTshp7yj65vXt/xbmVg//6RptIDa05myeEptmGG/d73OjI3N70wY/myXze1TfXO6sInPV+WXn7vw65Pz0LSkHy67tuSJo7Uz3Dn4uze4GSMQs8oYPmd16p33N3zWX/F5wNbKz3bym5u6dZIa+r+O4fWnufI8Vm+dY7bd2fyr2X5ZZqx/BGvw5/wD9H3jzz6pe5xfWcieo/I2/u/qLhxqjlLTs0LzQnu2IPpO6zqja/4jleZGm99cMo3QWanyNI0EWsCu8u6djUmwOkkbEyClhRoHk20zxUuTaQs75wHLlY8FLF91bLlgwNvbTr9flVf04UMOk+pZ5LCSqbAxTgT/mcJIGz53oVCRCFejUTISt4mpEckXTncRsELadCyCFsWhba0NEbxxf9yLhRCkuli8S3esBc0O610MehqDlm9dRFepJQ2ClxKwdF0oehdiyAsmR6o9YtGH685AHEUkJ3F13JKO610LMPfl8ROGo1luKJ3Z8CwSvyi7gG6W8C3CoqTQw5e6ykgW06x5dCVnGzLCKOZ1X2GKPAAkaho+CTNJ+o+qLtFw5lXbuZRd16+zqAbednBoKdLQtEPUmAYkduyFlRwUMbWYh5Bc0tmn/WWbHQzkp03/qClCRoWvUdQR1RzBJv3kBlTjZhihJDmFbWAZAwJ2MXjQQH7eXWCWfVuWgwDHBNxTDKioh6GWgjggIADvOrnsItTvSyyZ+Wx7KoHmlFM0TBF3YS6aZ3hf0Pe6lhnNUPWjKL/F4rXcD14nOPySSzNS87QS8otYBgFIw9MY4bQ7szY5SXNdJ4zMAEARyYGGuVhjnsBAAAAAgAAACYAAABHAwAAAAAAAAEAAAAAAAAAAAAAAA

[Folder]

[EncodedFile-AuthorEncoded-BGInfo4848.ico]
lines=0
0=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

